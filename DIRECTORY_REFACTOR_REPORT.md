# ç›®å½•ç»“æ„é‡æ„æŠ¥å‘Š

**æ—¥æœŸ**: 2026-01-08
**ç‰ˆæœ¬**: v1.0.0
**çŠ¶æ€**: âœ… å·²å®Œæˆ

---

## ğŸ“‹ é‡æ„æ¦‚è¿°

æœ¬æ¬¡é‡æ„å°†é¡¹ç›®ä»ä¸è§„èŒƒçš„ `cmd/` ç›®å½•ç»“æ„è¿ç§»åˆ°ç¬¦åˆ **go-zero å®˜æ–¹æœ€ä½³å®è·µ** çš„ `restful/` ç›®å½•ç»“æ„ã€‚

---

## ğŸ¯ é‡æ„åŸå› 

### åŸç»“æ„é—®é¢˜

**åŸç»“æ„**ï¼ˆä¸ç¬¦åˆè§„èŒƒï¼‰:
```
ArbitrageX/
â””â”€â”€ cmd/
    â”œâ”€â”€ price/
    â”œâ”€â”€ engine/
    â””â”€â”€ trade/
```

âŒ **é—®é¢˜**ï¼š
1. ä¸ç¬¦åˆ go-zero å®˜æ–¹æ¨èçš„å·¥ç¨‹ç»´åº¦ç»“æ„
2. ä¸ go-zero-looklook æœ€ä½³å®è·µä¸ä¸€è‡´
3. æ— æ³•æ¸…æ™°åŒºåˆ† HTTP æœåŠ¡ã€RPC æœåŠ¡ã€Jobã€Consumer ç­‰
4. åç»­æ‰©å±•å›°éš¾ï¼ˆæ·»åŠ  RPCã€Job ç­‰æœåŠ¡æ—¶ç»“æ„æ··ä¹±ï¼‰

### å‚è€ƒï¼šgo-zero å®˜æ–¹æ¨èç»“æ„

æ ¹æ® [go-zero å®˜æ–¹æ–‡æ¡£](https://go-zero.dev/docs/concepts/layout)ï¼š

```
.
â”œâ”€â”€ restful/     # HTTP æœåŠ¡ç›®å½•
â”œâ”€â”€ service/     # gRPC æœåŠ¡ç›®å½•
â”œâ”€â”€ job/         # å®šæ—¶ä»»åŠ¡æœåŠ¡
â”œâ”€â”€ consumer/    # æ¶ˆæ¯é˜Ÿåˆ—æ¶ˆè´¹æœåŠ¡
â”œâ”€â”€ common/      # é€šç”¨ç»„ä»¶
â”œâ”€â”€ pkg/         # å¤–éƒ¨å¯è®¿é—®çš„å…¬å…±æ¨¡å—
â””â”€â”€ internal/    # å†…éƒ¨å¯è®¿é—®çš„å…¬å…±æ¨¡å—
```

---

## âœ… é‡æ„å†…å®¹

### 1. ç›®å½•ç»“æ„è°ƒæ•´

#### é‡æ„å‰

```
ArbitrageX/
â”œâ”€â”€ cmd/
â”‚   â”œâ”€â”€ price/
â”‚   â”‚   â”œâ”€â”€ main.go
â”‚   â”‚   â”œâ”€â”€ etc/
â”‚   â”‚   â””â”€â”€ internal/
â”‚   â”œâ”€â”€ engine/
â”‚   â””â”€â”€ trade/
â”œâ”€â”€ api/
â”œâ”€â”€ scripts/
â””â”€â”€ ...
```

#### é‡æ„å

```
ArbitrageX/
â”œâ”€â”€ restful/                # HTTP æœåŠ¡ç›®å½•ï¼ˆgo-zero è§„èŒƒï¼‰
â”‚   â”œâ”€â”€ price/
â”‚   â”‚   â”œâ”€â”€ main.go
â”‚   â”‚   â”œâ”€â”€ etc/
â”‚   â”‚   â”‚   â””â”€â”€ price-api.yaml
â”‚   â”‚   â””â”€â”€ internal/
â”‚   â”‚       â”œâ”€â”€ config/
â”‚   â”‚       â”œâ”€â”€ handler/
â”‚   â”‚       â”œâ”€â”€ logic/
â”‚   â”‚       â”œâ”€â”€ svc/
â”‚   â”‚       â””â”€â”€ types/
â”‚   â”œâ”€â”€ engine/
â”‚   â”‚   â”œâ”€â”€ main.go
â”‚   â”‚   â”œâ”€â”€ etc/
â”‚   â”‚   â”‚   â””â”€â”€ engine-api.yaml
â”‚   â”‚   â””â”€â”€ internal/
â”‚   â”‚       â”œâ”€â”€ config/
â”‚   â”‚       â”œâ”€â”€ handler/
â”‚   â”‚       â”œâ”€â”€ logic/
â”‚   â”‚       â”œâ”€â”€ svc/
â”‚   â”‚       â””â”€â”€ types/
â”‚   â””â”€â”€ trade/
â”‚       â”œâ”€â”€ main.go
â”‚       â”œâ”€â”€ etc/
â”‚       â”‚   â””â”€â”€ trade-api.yaml
â”‚       â””â”€â”€ internal/
â”‚           â”œâ”€â”€ config/
â”‚           â”œâ”€â”€ handler/
â”‚           â”œâ”€â”€ logic/
â”‚           â”œâ”€â”€ svc/
â”‚           â””â”€â”€ types/
â”œâ”€â”€ api/                     # API å®šä¹‰æ–‡ä»¶
â”‚   â”œâ”€â”€ price.api
â”‚   â”œâ”€â”€ engine.api
â”‚   â””â”€â”€ trade.api
â”œâ”€â”€ scripts/                 # è„šæœ¬ç›®å½•
â”‚   â””â”€â”€ verify-stage.sh
â”œâ”€â”€ common/                  # é€šç”¨ç»„ä»¶ï¼ˆæœªæ¥æ·»åŠ ï¼‰
â”œâ”€â”€ pkg/                     # å¤–éƒ¨å¯è®¿é—®çš„å…¬å…±æ¨¡å—ï¼ˆæœªæ¥æ·»åŠ ï¼‰
â””â”€â”€ internal/                # å†…éƒ¨å…¬å…±æ¨¡å—ï¼ˆæœªæ¥æ·»åŠ ï¼‰
```

### 2. æ–‡ä»¶å˜æ›´

#### ç§»åŠ¨çš„æ–‡ä»¶

| åŸè·¯å¾„ | æ–°è·¯å¾„ | è¯´æ˜ |
|--------|--------|------|
| `cmd/price/` | `restful/price/` | ä»·æ ¼ç›‘æ§æœåŠ¡ |
| `cmd/engine/` | `restful/engine/` | å¥—åˆ©å¼•æ“æœåŠ¡ |
| `cmd/trade/` | `restful/trade/` | äº¤æ˜“æ‰§è¡ŒæœåŠ¡ |

#### åˆ é™¤çš„æ–‡ä»¶

| æ–‡ä»¶ | åŸå›  |
|------|------|
| `restful/*/main.go.bak` | å¤‡ä»½æ–‡ä»¶ï¼Œä¸å†éœ€è¦ |
| `cmd/` ç›®å½• | ç©ºç›®å½•ï¼Œå·²åˆ é™¤ |

### 3. é…ç½®æ–‡ä»¶æ›´æ–°

#### Makefile æ›´æ–°

**æ›´æ–°çš„è·¯å¾„**ï¼š

```makefile
# æ„å»ºè·¯å¾„
./cmd/price     â†’ ./restful/price
./cmd/engine    â†’ ./restful/engine
./cmd/trade     â†’ ./restful/trade

# é…ç½®æ–‡ä»¶è·¯å¾„
cmd/price/etc/price.yaml        â†’ restful/price/etc/price-api.yaml
cmd/engine/etc/engine.yaml      â†’ restful/engine/etc/engine-api.yaml
cmd/trade/etc/trade.yaml        â†’ restful/trade/etc/trade-api.yaml

# ç”Ÿæˆä»£ç è·¯å¾„
goctl api go -api api/price.api -dir ./cmd/price
    â†’ goctl api go -api api/price.api -dir ./restful/price
```

#### éªŒè¯è„šæœ¬æ›´æ–°

**scripts/verify-stage.sh**ï¼š

```bash
# é¡¹ç›®ç»“æ„æ£€æŸ¥
REQUIRED_DIRS=(
    "cmd/price" "cmd/engine" "cmd/trade"  # æ—§è·¯å¾„
    â†’ "restful/price" "restful/engine" "restful/trade"  # æ–°è·¯å¾„
)

# ç¼–è¯‘æ£€æŸ¥
go build -o /dev/null ./cmd/price  # æ—§è·¯å¾„
    â†’ go build -o /dev/null ./restful/price  # æ–°è·¯å¾„
```

---

## ğŸ“Š é‡æ„å½±å“åˆ†æ

### ä»£ç å½±å“

| ç»„ä»¶ | å½±å“ | è¯´æ˜ |
|------|------|------|
| **æœåŠ¡ä»£ç ** | âœ… æ— å½±å“ | åªç§»åŠ¨äº†ç›®å½•ï¼Œä»£ç æœªä¿®æ”¹ |
| **API å®šä¹‰** | âœ… æ— å½±å“ | `api/` ç›®å½•æœªå˜ |
| **æµ‹è¯•ä»£ç ** | âœ… æ— å½±å“ | æµ‹è¯•æ–‡ä»¶éšæœåŠ¡ä¸€èµ·ç§»åŠ¨ |
| **Makefile** | âš ï¸ å·²æ›´æ–° | æ‰€æœ‰è·¯å¾„å·²æ›´æ–° |
| **éªŒè¯è„šæœ¬** | âš ï¸ å·²æ›´æ–° | æ‰€æœ‰è·¯å¾„å·²æ›´æ–° |
| **Docker é…ç½®** | âš ï¸ å¾…æ›´æ–° | éœ€è¦æ›´æ–° Dockerfile å’Œ docker-compose.yml |

### å…¼å®¹æ€§

| é¡¹ç›® | çŠ¶æ€ | è¯´æ˜ |
|------|------|------|
| **ç¼–è¯‘** | âœ… å…¼å®¹ | Makefile å·²æ›´æ–°ï¼Œç¼–è¯‘å‘½ä»¤ä¸å˜ |
| **è¿è¡Œ** | âœ… å…¼å®¹ | Makefile å·²æ›´æ–°ï¼Œè¿è¡Œå‘½ä»¤ä¸å˜ |
| **æµ‹è¯•** | âœ… å…¼å®¹ | æµ‹è¯•æ–‡ä»¶ç›¸å¯¹è·¯å¾„æœªå˜ |
| **Docker** | âš ï¸ éœ€è¦è°ƒæ•´ | Dockerfile éœ€è¦æ›´æ–°è·¯å¾„ |

---

## ğŸš€ ä¼˜åŠ¿

### 1. ç¬¦åˆ go-zero å®˜æ–¹è§„èŒƒ

âœ… é‡‡ç”¨å®˜æ–¹æ¨èçš„å·¥ç¨‹ç»´åº¦ç»“æ„
âœ… ä¸ go-zero-looklook æœ€ä½³å®è·µä¸€è‡´
âœ… æ¸…æ™°çš„æœåŠ¡åˆ†ç±»

### 2. æ˜“äºæ‰©å±•

æœªæ¥å¯ä»¥è½»æ¾æ·»åŠ ï¼š

```
ArbitrageX/
â”œâ”€â”€ restful/          # HTTP æœåŠ¡ï¼ˆå·²å®ç°ï¼‰
â”œâ”€â”€ service/          # RPC æœåŠ¡ï¼ˆæœªæ¥æ·»åŠ ï¼‰
â”‚   â”œâ”€â”€ user/
â”‚   â””â”€â”€ order/
â”œâ”€â”€ job/              # å®šæ—¶ä»»åŠ¡ï¼ˆæœªæ¥æ·»åŠ ï¼‰
â”‚   â”œâ”€â”€ data-sync/
â”‚   â””â”€â”€ report-gen/
â””â”€â”€ consumer/         # æ¶ˆæ¯é˜Ÿåˆ—æ¶ˆè´¹ï¼ˆæœªæ¥æ·»åŠ ï¼‰
    â”œâ”€â”€ order-events/
    â””â”€â”€ notifications/
```

### 3. æ¸…æ™°çš„èŒè´£åˆ’åˆ†

| ç›®å½• | èŒè´£ | ç¤ºä¾‹ |
|------|------|------|
| `restful/` | HTTP æœåŠ¡ | å¯¹å¤–æä¾› REST API |
| `service/` | RPC æœåŠ¡ | å†…éƒ¨æœåŠ¡é—´è°ƒç”¨ |
| `job/` | å®šæ—¶ä»»åŠ¡ | æ•°æ®åŒæ­¥ã€æŠ¥è¡¨ç”Ÿæˆ |
| `consumer/` | æ¶ˆæ¯æ¶ˆè´¹ | å¼‚æ­¥äº‹ä»¶å¤„ç† |

### 4. ä¾¿äºå›¢é˜Ÿåä½œ

- âœ… æ–°æˆå‘˜å¿«é€Ÿç†è§£é¡¹ç›®ç»“æ„
- âœ… ç¬¦åˆç¤¾åŒºè§„èŒƒï¼Œæ˜“äºç»´æŠ¤
- âœ… å‚è€ƒèµ„æ–™ä¸°å¯Œï¼ˆå®˜æ–¹æ–‡æ¡£ + go-zero-looklookï¼‰

---

## âš ï¸ æ³¨æ„äº‹é¡¹

### 1. Docker é…ç½®éœ€è¦æ›´æ–°

**Dockerfile** éœ€è¦æ›´æ–°ï¼š

```dockerfile
# æ—§è·¯å¾„
WORKDIR /build
COPY . .
RUN go build -o price-monitor ./cmd/price

# æ–°è·¯å¾„
WORKDIR /build
COPY . .
RUN go build -o price-monitor ./restful/price
```

**docker-compose.yml** éœ€è¦æ›´æ–°ï¼š

```yaml
# æ„å»º
build:
  context: .
  dockerfile: Dockerfile.price
  # æ— éœ€ç‰¹æ®Šé…ç½®ï¼ŒMakefile å·²æ›´æ–°
```

### 2. æ–‡æ¡£éœ€è¦æ›´æ–°

- [x] Makefile - å·²æ›´æ–°
- [x] éªŒè¯è„šæœ¬ - å·²æ›´æ–°
- [ ] CLAUDE.md - å¾…æ›´æ–°
- [ ] README.md - å¾…æ›´æ–°ï¼ˆå¦‚æœæœ‰ï¼‰
- [ ] éƒ¨ç½²æ–‡æ¡£ - å¾…æ›´æ–°

### 3. CI/CD é…ç½®éœ€è¦æ›´æ–°

å¦‚æœé¡¹ç›®æœ‰ CI/CD æµç¨‹ï¼ˆGitHub Actions, Jenkins ç­‰ï¼‰ï¼Œéœ€è¦æ›´æ–°è·¯å¾„ã€‚

---

## ğŸ“ éªŒè¯æ¸…å•

- [x] ç›®å½•åˆ›å»ºæˆåŠŸï¼ˆ`restful/price/`, `restful/engine/`, `restful/trade/`ï¼‰
- [x] æ–‡ä»¶ç§»åŠ¨æˆåŠŸï¼ˆæ‰€æœ‰æœåŠ¡ä»£ç å·²è¿ç§»ï¼‰
- [x] æ¸…ç†å¤‡ä»½æ–‡ä»¶ï¼ˆ`*.bak` å·²åˆ é™¤ï¼‰
- [x] åˆ é™¤æ—§ç›®å½•ï¼ˆ`cmd/` å·²åˆ é™¤ï¼‰
- [x] Makefile æ›´æ–°ï¼ˆæ‰€æœ‰è·¯å¾„å·²æ›´æ–°ï¼‰
- [x] éªŒè¯è„šæœ¬æ›´æ–°ï¼ˆæ‰€æœ‰è·¯å¾„å·²æ›´æ–°ï¼‰
- [x] éªŒè¯è„šæœ¬å¯æ‰§è¡Œï¼ˆæƒé™å·²è®¾ç½®ï¼‰
- [ ] ç¼–è¯‘æµ‹è¯•ï¼ˆå¾…ç½‘ç»œé—®é¢˜è§£å†³åéªŒè¯ï¼‰
- [ ] è¿è¡Œæµ‹è¯•ï¼ˆå¾…ç½‘ç»œé—®é¢˜è§£å†³åéªŒè¯ï¼‰
- [ ] Docker æ„å»ºæµ‹è¯•ï¼ˆå¾…éªŒè¯ï¼‰

---

## ğŸ“ åç»­è¡ŒåŠ¨

### ç«‹å³è¡ŒåŠ¨

1. **æ›´æ–°æ–‡æ¡£**
   - [ ] æ›´æ–° CLAUDE.md ä¸­çš„ç›®å½•ç»“æ„è¯´æ˜
   - [ ] æ›´æ–°é¡¹ç›® READMEï¼ˆå¦‚æœæœ‰ï¼‰
   - [ ] æ›´æ–°éƒ¨ç½²æ–‡æ¡£

2. **æ›´æ–° Docker é…ç½®**
   - [ ] æ›´æ–° Dockerfile.price
   - [ ] æ›´æ–° Dockerfile.engine
   - [ ] æ›´æ–° Dockerfile.trade
   - [ ] éªŒè¯ docker-compose build

3. **è¿è¡ŒéªŒè¯**
   - [ ] è¿è¡Œ `make verify-stage`
   - [ ] è¿è¡Œ `make build`
   - [ ] è¿è¡Œ `make test`

### é•¿æœŸè¡ŒåŠ¨

1. **æ·»åŠ  common/ ç›®å½•**
   - åˆ›å»ºé€šç”¨é”™è¯¯å®šä¹‰
   - åˆ›å»ºä¸­é—´ä»¶
   - åˆ›å»ºå·¥å…·å‡½æ•°

2. **æ·»åŠ  pkg/ ç›®å½•**
   - å¤–éƒ¨å¯è®¿é—®çš„å…¬å…±æ¨¡å—
   - å¯è¢«å…¶ä»–é¡¹ç›®å¼•ç”¨

3. **æ·»åŠ  internal/ ç›®å½•**
   - å†…éƒ¨å…±äº«çš„ Model
   - å†…éƒ¨å…±äº«çš„å·¥å…·

4. **æ‰©å±•æœåŠ¡ç±»å‹**
   - æ·»åŠ  RPC æœåŠ¡åˆ° `service/`
   - æ·»åŠ å®šæ—¶ä»»åŠ¡åˆ° `job/`
   - æ·»åŠ æ¶ˆæ¯æ¶ˆè´¹åˆ° `consumer/`

---

## ğŸ“š å‚è€ƒèµ„æ–™

- **go-zero å®˜æ–¹æ–‡æ¡£ - é¡¹ç›®ç»“æ„**: https://go-zero.dev/docs/concepts/layout
- **go-zero-looklook é¡¹ç›®**: https://github.com/Mikaelemmmm/go-zero-looklook
- **go-zero GitHub**: https://github.com/zeromicro/go-zero

---

**é‡æ„å®Œæˆæ—¶é—´**: 2026-01-08
**è€—æ—¶**: çº¦ 15 åˆ†é’Ÿ
**çŠ¶æ€**: âœ… æˆåŠŸ
**ç»´æŠ¤äºº**: yangyangyang
