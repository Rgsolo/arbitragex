# ArbitrageX æŠ€æœ¯éœ€æ±‚æ–‡æ¡£

**ç‰ˆæœ¬**: v2.0.0
**åˆ›å»ºæ—¥æœŸ**: 2026-01-07
**æœ€åæ›´æ–°**: 2026-01-07
**ç»´æŠ¤äºº**: ArbitrageX å¼€å‘å›¢é˜Ÿ

---

## ğŸ“ å˜æ›´æ—¥å¿—

### v2.0.0 (2026-01-07)
- **æ–°å¢**: ä»ä¸» PRD æå–æŠ€æœ¯éœ€æ±‚ç« èŠ‚
- **æ–°å¢**: éåŠŸèƒ½éœ€æ±‚è¯¦ç»†è¯´æ˜
- **æ–°å¢**: æ•°æ®éœ€æ±‚å’Œæ¥å£éœ€æ±‚
- **æ–°å¢**: æŠ€æœ¯çº¦æŸå’Œé€‰å‹è¦æ±‚
- **ä¼˜åŒ–**: éƒ¨ç½²å’Œè¿ç»´éœ€æ±‚

### v1.0.0 (2026-01-06)
- åˆå§‹ç‰ˆæœ¬ï¼Œä½œä¸ºä¸» PRD çš„ä¸€éƒ¨åˆ†

---

## ğŸ“š æ–‡æ¡£è¯´æ˜

æœ¬æ–‡æ¡£è¯¦ç»†é˜è¿°äº† ArbitrageX ç³»ç»Ÿçš„æŠ€æœ¯éœ€æ±‚ï¼ŒåŒ…æ‹¬éåŠŸèƒ½éœ€æ±‚ã€æ•°æ®éœ€æ±‚ã€æ¥å£éœ€æ±‚ã€æŠ€æœ¯çº¦æŸå’Œéƒ¨ç½²è¿ç»´éœ€æ±‚ã€‚

**ç›¸å…³æ–‡æ¡£**:
- æ ¸å¿ƒäº§å“éœ€æ±‚: [PRD_Core.md](./PRD_Core.md)
- å®æ–½è®¡åˆ’: [PRD_Implementation.md](./PRD_Implementation.md)
- CEX å¥—åˆ©ç­–ç•¥: [Strategies/Strategy_CEX_Arbitrage.md](./Strategies/Strategy_CEX_Arbitrage.md)
- DEX å¥—åˆ©ç­–ç•¥: [Strategies/Strategy_DEX_Arbitrage.md](./Strategies/Strategy_DEX_Arbitrage.md)

---

## 1. éåŠŸèƒ½éœ€æ±‚

### 1.1 æ€§èƒ½è¦æ±‚

#### 1.1.1 ç³»ç»Ÿå“åº”æ—¶é—´

| åŠŸèƒ½æ¨¡å— | æ€§èƒ½æŒ‡æ ‡ | æµ‹é‡æ–¹æ³• | éªŒæ”¶æ ‡å‡† |
|---------|---------|----------|----------|
| **ä»·æ ¼ç›‘æ§** | â‰¤ 100ms | WebSocket æ¨é€å»¶è¿Ÿç»Ÿè®¡ | 99% è¯·æ±‚æ»¡è¶³ |
| **å¥—åˆ©è¯†åˆ«** | â‰¤ 50ms | ä»æ¥æ”¶åˆ°ä»·æ ¼åˆ°è¾“å‡ºå†³ç­–çš„æ—¶é—´ | 99% è¯·æ±‚æ»¡è¶³ |
| **è®¢å•ä¸‹å•** | â‰¤ 100ms | API è°ƒç”¨å“åº”æ—¶é—´ | 95% è¯·æ±‚æ»¡è¶³ |
| **ä½™é¢æŸ¥è¯¢** | â‰¤ 500ms | API è°ƒç”¨å“åº”æ—¶é—´ | 95% è¯·æ±‚æ»¡è¶³ |
| **æ—¥å¿—è®°å½•** | â‰¤ 10ms | å¼‚æ­¥æ—¥å¿—å†™å…¥æ—¶é—´ | 99% è¯·æ±‚æ»¡è¶³ |

**æ€§èƒ½ç›‘æ§æŒ‡æ ‡**:
- P50 å»¶è¿Ÿï¼ˆä¸­ä½æ•°ï¼‰
- P95 å»¶è¿Ÿï¼ˆ95 åˆ†ä½ï¼‰
- P99 å»¶è¿Ÿï¼ˆ99 åˆ†ä½ï¼‰
- æœ€å¤§å»¶è¿Ÿ

#### 1.1.2 ç³»ç»Ÿååé‡

| æŒ‡æ ‡ | ç›®æ ‡å€¼ | æµ‹é‡æ–¹æ³• | éªŒæ”¶æ ‡å‡† |
|------|--------|----------|----------|
| **ç›‘æ§äº¤æ˜“å¯¹æ•°é‡** | 100+ | é…ç½®çš„äº¤æ˜“å¯¹æ€»æ•° | â‰¥ 100 |
| **å¹¶å‘å¥—åˆ©æ‰§è¡Œ** | 10+ | åŒæ—¶æ‰§è¡Œçš„å¥—åˆ©äº¤æ˜“æ•° | â‰¥ 10 |
| **ä»·æ ¼æ›´æ–°é¢‘ç‡** | CEX â‰¤ 100ms | WebSocket æ¨é€é¢‘ç‡ | æ»¡è¶³è¦æ±‚ |
| **ä»·æ ¼æ›´æ–°é¢‘ç‡** | DEX â‰¤ 500ms | é“¾ä¸Šè½®è¯¢é¢‘ç‡ | æ»¡è¶³è¦æ±‚ |
| **API è¯·æ±‚ QPS** | 100+ | æ¯ç§’ API è°ƒç”¨æ¬¡æ•° | â‰¥ 100 |

#### 1.1.3 èµ„æºå ç”¨

| èµ„æº | æ­£å¸¸è´Ÿè½½ | å³°å€¼è´Ÿè½½ | å‘Šè­¦é˜ˆå€¼ |
|------|----------|----------|----------|
| **CPU ä½¿ç”¨ç‡** | â‰¤ 50% | â‰¤ 70% | > 80% |
| **å†…å­˜å ç”¨** | â‰¤ 1GB | â‰¤ 2GB | > 2.5GB |
| **ç½‘ç»œå¸¦å®½** | â‰¤ 5Mbps | â‰¤ 10Mbps | > 12Mbps |
| **ç£ç›˜ I/O** | â‰¤ 10% | â‰¤ 30% | > 50% |
| **Goroutine æ•°é‡** | â‰¤ 1,000 | â‰¤ 2,000 | > 3,000 |

#### 1.1.4 æ€§èƒ½ä¼˜åŒ–ç­–ç•¥

```
1. è¿æ¥æ± ç®¡ç†
   â”œâ”€ HTTP å®¢æˆ·ç«¯è¿æ¥æ± ï¼ˆæœ€å¤§ 100 è¿æ¥ï¼‰
   â”œâ”€ WebSocket é•¿è¿æ¥å¤ç”¨
   â””â”€ æ•°æ®åº“è¿æ¥æ± ï¼ˆæœ€å¤§ 50 è¿æ¥ï¼‰

2. ç¼“å­˜ç­–ç•¥
   â”œâ”€ ä»·æ ¼æ•°æ®ç¼“å­˜ï¼ˆTTL: 100msï¼‰
   â”œâ”€ äº¤æ˜“æ‰€ API å“åº”ç¼“å­˜ï¼ˆTTL: 1sï¼‰
   â”œâ”€ è´¦æˆ·ä½™é¢ç¼“å­˜ï¼ˆTTL: 5sï¼‰
   â””â”€ ä½¿ç”¨ go-zero å†…ç½®ç¼“å­˜

3. å¹¶å‘æ§åˆ¶
   â”œâ”€ Goroutine æ± ï¼ˆæœ€å¤§ 2,000 ä¸ªï¼‰
   â”œâ”€ é™åˆ¶å¹¶å‘ API è°ƒç”¨ï¼ˆå•äº¤æ˜“æ‰€ â‰¤ 10 QPSï¼‰
   â””â”€ ä½¿ç”¨ channel è¿›è¡Œé€šä¿¡

4. æ•°æ®åº“ä¼˜åŒ–
   â”œâ”€ ç´¢å¼•ä¼˜åŒ–ï¼ˆäº¤æ˜“å¯¹ã€æ—¶é—´æˆ³ï¼‰
   â”œâ”€ åˆ†åŒºè¡¨ï¼ˆæŒ‰æœˆåˆ†åŒºï¼‰
   â”œâ”€ è¯»å†™åˆ†ç¦»ï¼ˆä¸»ä»å¤åˆ¶ï¼‰
   â””â”€ æ‰¹é‡æ’å…¥ï¼ˆæ¯ 100 æ¡æ‰¹é‡å†™å…¥ï¼‰

5. ç®—æ³•ä¼˜åŒ–
   â”œâ”€ å¥—åˆ©æœºä¼šè¯†åˆ«ç®—æ³•ä¼˜åŒ–ï¼ˆO(nÂ²) â†’ O(n)ï¼‰
   â”œâ”€ ä½¿ç”¨é«˜æ•ˆçš„æ•°æ®ç»“æ„ï¼ˆå †ã€å“ˆå¸Œè¡¨ï¼‰
   â””â”€ é¿å…é‡å¤è®¡ç®—ï¼ˆç¼“å­˜ä¸­é—´ç»“æœï¼‰
```

### 1.2 å¯é æ€§è¦æ±‚

#### 1.2.1 ç³»ç»Ÿå¯ç”¨æ€§

| æŒ‡æ ‡ | ç›®æ ‡å€¼ | æµ‹é‡æ–¹æ³• | éªŒæ”¶æ ‡å‡† |
|------|--------|----------|----------|
| **ç³»ç»Ÿå¯ç”¨æ€§** | â‰¥ 99.5% | (æ€»æ—¶é—´ - æ•…éšœæ—¶é—´) / æ€»æ—¶é—´ | æœˆåº¦ç»Ÿè®¡ |
| **MTBF** (å¹³å‡æ•…éšœé—´éš”) | â‰¥ 720 å°æ—¶ | æ•…éšœé—´éš”æ—¶é—´ç»Ÿè®¡ | æœˆåº¦ç»Ÿè®¡ |
| **MTTR** (å¹³å‡æ¢å¤æ—¶é—´) | â‰¤ 5 åˆ†é’Ÿ | æ•…éšœæ¢å¤æ—¶é—´ç»Ÿè®¡ | æœˆåº¦ç»Ÿè®¡ |
| **æ•°æ®ä¸€è‡´æ€§** | å¼ºä¸€è‡´æ€§ | äº¤æ˜“æ•°æ®å¯¹æ¯” | 100% ä¸€è‡´ |

**å¯ç”¨æ€§ä¿éšœæªæ–½**:
- æœåŠ¡å†—ä½™éƒ¨ç½²ï¼ˆä¸»å¤‡åˆ‡æ¢ï¼‰
- è‡ªåŠ¨æ•…éšœæ£€æµ‹å’Œæ¢å¤
- å®šæœŸæ•°æ®å¤‡ä»½
- ç†”æ–­å’Œé™çº§æœºåˆ¶

#### 1.2.2 æ•…éšœæ¢å¤

```
æ•…éšœç±»å‹å’Œæ¢å¤ç­–ç•¥:

1. äº¤æ˜“æ‰€ API æ•…éšœ
   â”œâ”€ æ£€æµ‹: API è°ƒç”¨è¿ç»­å¤±è´¥ 3 æ¬¡
   â”œâ”€ æ¢å¤: è‡ªåŠ¨é‡è¯•ï¼ˆæŒ‡æ•°é€€é¿ï¼‰
   â”œâ”€ é™çº§: æš‚åœè¯¥äº¤æ˜“æ‰€å¥—åˆ©
   â””â”€ å‘Šè­¦: ç«‹å³é€šçŸ¥è¿ç»´äººå‘˜

2. æ•°æ®åº“æ•…éšœ
   â”œâ”€ æ£€æµ‹: æ•°æ®åº“è¿æ¥å¤±è´¥
   â”œâ”€ æ¢å¤: åˆ‡æ¢åˆ°ä»åº“
   â”œâ”€ é™çº§: ä»…è®°å½•æ—¥å¿—ï¼Œä¸å†™å…¥æ•°æ®åº“
   â””â”€ å‘Šè­¦: ç«‹å³é€šçŸ¥è¿ç»´äººå‘˜

3. ç½‘ç»œæ•…éšœ
   â”œâ”€ æ£€æµ‹: ç½‘ç»œè¶…æ—¶ï¼ˆ> 30sï¼‰
   â”œâ”€ æ¢å¤: ç­‰å¾…ç½‘ç»œæ¢å¤
   â”œâ”€ é™çº§: æš‚åœæ‰€æœ‰äº¤æ˜“
   â””â”€ å‘Šè­¦: ç«‹å³é€šçŸ¥è¿ç»´äººå‘˜

4. å†…å­˜ä¸è¶³
   â”œâ”€ æ£€æµ‹: å†…å­˜ä½¿ç”¨ç‡ > 90%
   â”œâ”€ æ¢å¤: é‡Šæ”¾ç¼“å­˜ï¼Œé‡å¯æœåŠ¡
   â”œâ”€ é™çº§: é™ä½å¹¶å‘åº¦
   â””â”€ å‘Šè­¦: ç«‹å³é€šçŸ¥è¿ç»´äººå‘˜

5. Gas è´¹å¼‚å¸¸
   â”œâ”€ æ£€æµ‹: Gas è´¹ > 50 USDT
   â”œâ”€ æ¢å¤: ç­‰å¾… Gas è´¹ä¸‹é™
   â”œâ”€ é™çº§: æš‚åœ DEX å¥—åˆ©
   â””â”€ å‘Šè­¦: è®°å½•æ—¥å¿—ï¼Œä¸ç«‹å³é€šçŸ¥
```

#### 1.2.3 æ•°æ®å¤‡ä»½

```
å¤‡ä»½ç­–ç•¥:

1. æ•°æ®åº“å¤‡ä»½
   â”œâ”€ å…¨é‡å¤‡ä»½: æ¯å¤©å‡Œæ™¨ 2 ç‚¹
   â”œâ”€ å¢é‡å¤‡ä»½: æ¯ 4 å°æ—¶ä¸€æ¬¡
   â”œâ”€ binlog å¤‡ä»½: å®æ—¶
   â””â”€ ä¿ç•™æ—¶é—´: 30 å¤©

2. é…ç½®æ–‡ä»¶å¤‡ä»½
   â”œâ”€ ç‰ˆæœ¬æ§åˆ¶: Git ä»“åº“
   â”œâ”€ å¤‡ä»½é¢‘ç‡: æ¯æ¬¡ä¿®æ”¹å
   â””â”€ ä¿ç•™æ—¶é—´: æ°¸ä¹…

3. æ—¥å¿—å¤‡ä»½
   â”œâ”€ æ—¥å¿—è½®è½¬: æ¯å¤©ä¸€ä¸ªæ–‡ä»¶
   â”œâ”€ å‹ç¼©: 7 å¤©å‰çš„æ—¥å¿—è‡ªåŠ¨å‹ç¼©
   â””â”€ ä¿ç•™æ—¶é—´: 90 å¤©

4. å¤‡ä»½éªŒè¯
   â”œâ”€ æ¯å‘¨æ¢å¤æµ‹è¯•: éªŒè¯å¤‡ä»½å¯ç”¨æ€§
   â”œâ”€ æ¢å¤æ—¶é—´ç›®æ ‡: â‰¤ 1 å°æ—¶
   â””â”€ æ•°æ®å®Œæ•´æ€§æ ¡éªŒ: MD5/SHA256
```

### 1.3 å®‰å…¨æ€§è¦æ±‚

#### 1.3.1 API å¯†é’¥å®‰å…¨

**å¯†é’¥å­˜å‚¨**:
```
å®‰å…¨æªæ–½:
1. åŠ å¯†å­˜å‚¨
   â”œâ”€ ç®—æ³•: AES-256-GCM
   â”œâ”€ å¯†é’¥é•¿åº¦: 256 ä½
   â”œâ”€ å¯†é’¥æ´¾ç”Ÿ: PBKDF2 (100,000 æ¬¡è¿­ä»£)
   â””â”€ å­˜å‚¨ä½ç½®: é…ç½®æ–‡ä»¶ï¼ˆç‹¬ç«‹æ–‡ä»¶ï¼Œæƒé™ 600ï¼‰

2. ç¯å¢ƒéš”ç¦»
   â”œâ”€ å¼€å‘ç¯å¢ƒ: ä½¿ç”¨æµ‹è¯•ç½‘å¯†é’¥
   â”œâ”€ æµ‹è¯•ç¯å¢ƒ: ä½¿ç”¨æµ‹è¯•ç½‘å¯†é’¥
   â””â”€ ç”Ÿäº§ç¯å¢ƒ: ä½¿ç”¨ä¸»ç½‘å¯†é’¥ï¼ˆä¸¥æ ¼éš”ç¦»ï¼‰

3. è®¿é—®æ§åˆ¶
   â”œâ”€ æ–‡ä»¶æƒé™: 600 (ä»…æ‰€æœ‰è€…å¯è¯»å†™)
   â”œâ”€ ç›®å½•æƒé™: 700 (ä»…æ‰€æœ‰è€…å¯è®¿é—®)
   â””â”€ ç¦æ­¢: å¯†é’¥ä¸å¾—å‡ºç°åœ¨ä»£ç æˆ–æ—¥å¿—ä¸­

4. å¯†é’¥è½®æ¢
   â”œâ”€ è½®æ¢å‘¨æœŸ: æ¯ 90 å¤©
   â”œâ”€ ç´§æ€¥è½®æ¢: å¯†é’¥æ³„éœ²æ—¶ç«‹å³æ›´æ¢
   â””â”€ æ”¯æŒå¤šå¥—å¯†é’¥: ä¸»å¤‡åˆ‡æ¢
```

**API å¯†é’¥æƒé™**:
```
æƒé™æœ€å°åŒ–åŸåˆ™:

1. è¯»å–æƒé™ï¼ˆåªè¯» API Keyï¼‰
   â”œâ”€ âœ… æŸ¥è¯¢è´¦æˆ·ä½™é¢
   â”œâ”€ âœ… æŸ¥è¯¢è®¢å•çŠ¶æ€
   â”œâ”€ âœ… æŸ¥è¯¢äº¤æ˜“å¯¹ä¿¡æ¯
   â””â”€ âŒ ä¸‹å•äº¤æ˜“

2. äº¤æ˜“æƒé™ï¼ˆäº¤æ˜“ API Keyï¼‰
   â”œâ”€ âœ… æŸ¥è¯¢è´¦æˆ·ä½™é¢
   â”œâ”€ âœ… ä¸‹å•äº¤æ˜“
   â”œâ”€ âœ… æŸ¥è¯¢è®¢å•çŠ¶æ€
   â”œâ”€ âœ… å–æ¶ˆè®¢å•
   â””â”€ âŒ æå¸ï¼ˆä¸¥æ ¼ç¦æ­¢ï¼‰

3. ç¦æ­¢æƒé™
   â”œâ”€ âŒ æå¸
   â”œâ”€ âŒ è½¬è´¦
   â”œâ”€ âŒ ä¿®æ”¹è´¦æˆ·è®¾ç½®
   â””â”€ âŒ API å¯†é’¥ç®¡ç†
```

#### 1.3.2 ç½‘ç»œå®‰å…¨

```
å®‰å…¨æªæ–½:

1. IP ç™½åå•
   â”œâ”€ é…ç½®æ‰€æœ‰äº¤æ˜“æ‰€ IP ç™½åå•
   â”œâ”€ ä»…å…è®¸æœåŠ¡å™¨ IP è®¿é—®
   â””â”€ å®šæœŸæ›´æ–°ç™½åå•

2. ä¼ è¾“åŠ å¯†
   â”œâ”€ HTTPS: å¼ºåˆ¶ä½¿ç”¨ TLS 1.3
   â”œâ”€ WSS: WebSocket Secure (TLS 1.3)
   â””â”€ ç¦ç”¨: TLS 1.0/1.1ï¼ˆå·²ä¸å®‰å…¨ï¼‰

3. è¯·æ±‚ç­¾å
   â”œâ”€ API è¯·æ±‚ç­¾å: HMAC-SHA256
   â”œâ”€ æ—¶é—´æˆ³éªŒè¯: Â± 5 ç§’
   â””â”€ Nonce: é˜²é‡æ”¾æ”»å‡»

4. DDoS é˜²æŠ¤
   â”œâ”€ é™æµ: å• IP 100 QPS
   â”œâ”€ é»‘åå•: è‡ªåŠ¨å°ç¦æ¶æ„ IP
   â””â”€ Cloudflare: å¯é€‰çš„ DDoS é˜²æŠ¤æœåŠ¡
```

#### 1.3.3 æ—¥å¿—å®‰å…¨

```
æ•æ„Ÿä¿¡æ¯è„±æ•:

1. API å¯†é’¥è„±æ•
   â”œâ”€ è®°å½•: API Key å‰ 8 ä½ + å 4 ä½
   â”œâ”€ ç¤ºä¾‹: "ABC12345...XYZ"
   â””â”€ ç¦æ­¢: è®°å½•å®Œæ•´å¯†é’¥

2. è´¦æˆ·ä¿¡æ¯è„±æ•
   â”œâ”€ è´¦æˆ·ä½™é¢: ä»…è®°å½•é‡‘é¢
   â”œâ”€ è®¢å• ID: å®Œæ•´è®°å½•ï¼ˆç”¨äºè¿½æº¯ï¼‰
   â””â”€ äº¤æ˜“å“ˆå¸Œ: å®Œæ•´è®°å½•ï¼ˆç”¨äºè¿½æº¯ï¼‰

3. æ—¥å¿—è®¿é—®æ§åˆ¶
   â”œâ”€ æ–‡ä»¶æƒé™: 600 (ä»…æ‰€æœ‰è€…å¯è¯»å†™)
   â”œâ”€ æ—¥å¿—ç›®å½•: 700 (ä»…æ‰€æœ‰è€…å¯è®¿é—®)
   â””â”€ ç¦æ­¢: æ—¥å¿—ä¸å¾—å…¬å¼€æˆ–ä¸Šä¼ åˆ°ç¬¬ä¸‰æ–¹

4. æ—¥å¿—å®¡è®¡
   â”œâ”€ å®¡è®¡å‘¨æœŸ: æ¯å‘¨ä¸€æ¬¡
   â”œâ”€ å®¡è®¡å†…å®¹: æ£€æŸ¥æ•æ„Ÿä¿¡æ¯æ³„éœ²
   â””â”€ å®¡è®¡äººå‘˜: å®‰å…¨è´Ÿè´£äºº
```

#### 1.3.4 æ“ä½œå®¡è®¡

```
å®¡è®¡æ—¥å¿—:

1. å®¡è®¡èŒƒå›´
   â”œâ”€ æ‰€æœ‰äº¤æ˜“æ“ä½œ
   â”œâ”€ æ‰€æœ‰å…³é”®é…ç½®å˜æ›´
   â”œâ”€ æ‰€æœ‰ API å¯†é’¥æ“ä½œ
   â””â”€ æ‰€æœ‰èµ„é‡‘æ“ä½œ

2. å®¡è®¡å†…å®¹
   â”œâ”€ æ“ä½œæ—¶é—´: ç²¾ç¡®åˆ°æ¯«ç§’
   â”œâ”€ æ“ä½œç±»å‹: åˆ›å»º/è¯»å–/æ›´æ–°/åˆ é™¤
   â”œâ”€ æ“ä½œç”¨æˆ·: æœåŠ¡æ ‡è¯†
   â”œâ”€ æ“ä½œå¯¹è±¡: èµ„æºæ ‡è¯†
   â”œâ”€ æ“ä½œç»“æœ: æˆåŠŸ/å¤±è´¥
   â””â”€ æ“ä½œè¯¦æƒ…: å…³é”®å‚æ•°ï¼ˆè„±æ•ï¼‰

3. å®¡è®¡æ—¥å¿—ä¿ç•™
   â”œâ”€ ä¿ç•™æ—¶é—´: 180 å¤©
   â”œâ”€ å­˜å‚¨ä½ç½®: ç‹¬ç«‹çš„å®¡è®¡æ—¥å¿—æ•°æ®åº“
   â””â”€ è®¿é—®æƒé™: ä»…å®‰å…¨è´Ÿè´£äºº

4. å®¡è®¡æŠ¥å‘Š
   â”œâ”€ ç”Ÿæˆå‘¨æœŸ: æ¯å‘¨ä¸€æ¬¡
   â”œâ”€ æŠ¥å‘Šå†…å®¹: å¼‚å¸¸æ“ä½œæ±‡æ€»
   â””â”€ æŠ¥å‘Šåˆ†å‘: å®‰å…¨è´Ÿè´£äººã€å›¢é˜Ÿè´Ÿè´£äºº
```

#### 1.3.5 2FA æ”¯æŒï¼ˆå¯é€‰ï¼‰

```
åŒå› ç´ è®¤è¯:

1. åº”ç”¨åœºæ™¯
   â”œâ”€ ç³»ç»Ÿå¯åŠ¨: éœ€è¦ 2FA éªŒè¯
   â”œâ”€ æ•æ„Ÿæ“ä½œ: éœ€è¦ 2FA éªŒè¯
   â””â”€ API å¯†é’¥è®¿é—®: éœ€è¦ 2FA éªŒè¯

2. 2FA æ–¹å¼
   â”œâ”€ TOTP: åŸºäºæ—¶é—´çš„ä¸€æ¬¡æ€§å¯†ç ï¼ˆGoogle Authenticatorï¼‰
   â”œâ”€ SMS: çŸ­ä¿¡éªŒè¯ç ï¼ˆå¯é€‰ï¼‰
   â””â”€ Email: é‚®ä»¶éªŒè¯ç ï¼ˆå¯é€‰ï¼‰

3. å®ç°æ–¹å¼
   â”œâ”€ ä½¿ç”¨ go-zero çš„ä¸­é—´ä»¶
   â”œâ”€ é›†æˆ TOTP åº“
   â””â”€ é…ç½® 2FA å¯†é’¥ï¼ˆBase32 ç¼–ç ï¼‰
```

### 1.4 å¯æ‰©å±•æ€§è¦æ±‚

#### 1.4.1 æ¨¡å—åŒ–è®¾è®¡

```
æ¨¡å—åˆ’åˆ†:

1. æ ¸å¿ƒæ¨¡å—
   â”œâ”€ ä»·æ ¼ç›‘æ§æ¨¡å— (price_monitor)
   â”œâ”€ å¥—åˆ©è¯†åˆ«æ¨¡å— (arbitrage_detector)
   â”œâ”€ äº¤æ˜“æ‰§è¡Œæ¨¡å— (trade_executor)
   â”œâ”€ é£é™©æ§åˆ¶æ¨¡å— (risk_manager)
   â””â”€ è´¦æˆ·ç®¡ç†æ¨¡å— (account_manager)

2. æ”¯æ’‘æ¨¡å—
   â”œâ”€ é…ç½®ç®¡ç†æ¨¡å— (config_manager)
   â”œâ”€ æ—¥å¿—ç›‘æ§æ¨¡å— (logger)
   â”œâ”€ å‘Šè­¦æ¨¡å— (alerter)
   â””â”€ æ•°æ®åº“æ¨¡å— (database)

3. é€‚é…å™¨æ¨¡å—
   â”œâ”€ äº¤æ˜“æ‰€é€‚é…å™¨ (exchange_adapter)
   â”‚   â”œâ”€ Binance é€‚é…å™¨
   â”‚   â”œâ”€ OKX é€‚é…å™¨
   â”‚   â”œâ”€ Bybit é€‚é…å™¨
   â”‚   â””â”€ Uniswap é€‚é…å™¨
   â””â”€ å‘Šè­¦é€‚é…å™¨ (alert_adapter)
       â”œâ”€ é‚®ä»¶é€‚é…å™¨
       â”œâ”€ Telegram é€‚é…å™¨
       â””â”€ ä¼ä¸šå¾®ä¿¡é€‚é…å™¨
```

#### 1.4.2 æ°´å¹³æ‰©å±•

```
æ‰©å±•ç­–ç•¥:

1. æœåŠ¡æ‹†åˆ†
   â”œâ”€ ä»·æ ¼ç›‘æ§æœåŠ¡ (ç‹¬ç«‹éƒ¨ç½²)
   â”œâ”€ å¥—åˆ©å¼•æ“æœåŠ¡ (ç‹¬ç«‹éƒ¨ç½²)
   â””â”€ äº¤æ˜“æ‰§è¡ŒæœåŠ¡ (ç‹¬ç«‹éƒ¨ç½²)

2. è´Ÿè½½å‡è¡¡
   â”œâ”€ ç­–ç•¥: æŒ‰äº¤æ˜“æ‰€åˆ†é…
   â”œâ”€ ç­–ç•¥: æŒ‰äº¤æ˜“å¯¹åˆ†é…
   â””â”€ å®ç°: go-zero å†…ç½®è´Ÿè½½å‡è¡¡

3. æ•°æ®åº“æ‰©å±•
   â”œâ”€ è¯»å†™åˆ†ç¦»: ä¸»åº“å†™ï¼Œä»åº“è¯»
   â”œâ”€ åˆ†åº“åˆ†è¡¨: æŒ‰äº¤æ˜“æ‰€åˆ†åº“
   â””â”€ ç¼“å­˜å±‚: Redis ç¼“å­˜çƒ­ç‚¹æ•°æ®

4. æ¶ˆæ¯é˜Ÿåˆ—ï¼ˆå¯é€‰ï¼‰
   â”œâ”€ ç”¨é€”: å¼‚æ­¥å¤„ç†ã€è§£è€¦
   â”œâ”€ æŠ€æœ¯: Redis Streams / Kafka
   â””â”€ åœºæ™¯: ä»·æ ¼æ•°æ®æ¨é€ã€å‘Šè­¦æ¶ˆæ¯
```

#### 1.4.3 æ’ä»¶åŒ–è®¾è®¡

```
æ’ä»¶æœºåˆ¶:

1. äº¤æ˜“æ‰€æ’ä»¶
   â”œâ”€ æ¥å£å®šä¹‰: ExchangeAdapter æ¥å£
   â”œâ”€ æ’ä»¶æ³¨å†Œ: é…ç½®æ–‡ä»¶å£°æ˜
   â”œâ”€ æ’ä»¶åŠ è½½: å¯åŠ¨æ—¶åŠ¨æ€åŠ è½½
   â””â”€ æ’ä»¶çƒ­æ›´æ–°: æ”¯æŒï¼ˆå¯é€‰ï¼‰

2. å‘Šè­¦æ’ä»¶
   â”œâ”€ æ¥å£å®šä¹‰: Alerter æ¥å£
   â”œâ”€ æ’ä»¶æ³¨å†Œ: é…ç½®æ–‡ä»¶å£°æ˜
   â””â”€ æ’ä»¶åŠ è½½: å¯åŠ¨æ—¶åŠ¨æ€åŠ è½½

3. æ–°å¢æ’ä»¶æµç¨‹
   â”œâ”€ å®ç°æ¥å£å®šä¹‰
   â”œâ”€ ç¼–å†™æ’ä»¶ä»£ç 
   â”œâ”€ é…ç½®æ–‡ä»¶æ³¨å†Œ
   â””â”€ é‡å¯æœåŠ¡ç”Ÿæ•ˆ
```

### 1.5 å¯ç»´æŠ¤æ€§è¦æ±‚

#### 1.5.1 ä»£ç è§„èŒƒ

```
ç¼–ç è§„èŒƒ:

1. å‘½åè§„èŒƒ
   â”œâ”€ åŒ…å: å°å†™å•è¯ï¼Œä¸ä½¿ç”¨ä¸‹åˆ’çº¿
   â”œâ”€ å¸¸é‡: é©¼å³°å‘½åæˆ–å…¨å¤§å†™+ä¸‹åˆ’çº¿
   â”œâ”€ å˜é‡/å‡½æ•°: é©¼å³°å‘½å
   â””â”€ æ¥å£: ä»¥ -er ç»“å°¾ï¼ˆå¦‚ Readerï¼‰

2. æ ¼å¼è§„èŒƒ
   â”œâ”€ å·¥å…·: gofmt / goimports
   â”œâ”€ ç¼©è¿›: Tab
   â”œâ”€ è¡Œå®½: 120 å­—ç¬¦
   â””â”€ ç©ºè¡Œ: åˆç†ä½¿ç”¨ï¼Œæé«˜å¯è¯»æ€§

3. æ³¨é‡Šè§„èŒƒ
   â”œâ”€ åŒ…æ³¨é‡Š: è¯´æ˜åŒ…çš„ç”¨é€”
   â”œâ”€ å‡½æ•°æ³¨é‡Š: è¯´æ˜åŠŸèƒ½ã€å‚æ•°ã€è¿”å›å€¼
   â”œâ”€ å¤æ‚é€»è¾‘: æ·»åŠ è¯¦ç»†æ³¨é‡Š
   â””â”€ ç¦æ­¢: æ— æ„ä¹‰çš„æ³¨é‡Š

4. é”™è¯¯å¤„ç†
   â”œâ”€ ä¸å¿½ç•¥é”™è¯¯
   â”œâ”€ è®°å½•é”™è¯¯æ—¥å¿—
   â”œâ”€ ä½¿ç”¨é”™è¯¯åŒ…è£… (fmt.Errorf with %w)
   â””â”€ é¿å…panic
```

#### 1.5.2 æµ‹è¯•è¦æ±‚

```
æµ‹è¯•è¦†ç›–:

1. å•å…ƒæµ‹è¯•
   â”œâ”€ è¦†ç›–ç‡: â‰¥ 70%
   â”œâ”€ å·¥å…·: go test
   â”œâ”€ é£æ ¼: è¡¨é©±åŠ¨æµ‹è¯•
   â””â”€ Mock: ä½¿ç”¨ mockgen ç”Ÿæˆ mock

2. é›†æˆæµ‹è¯•
   â”œâ”€ è¦†ç›–ç‡: æ ¸å¿ƒæµç¨‹ 100%
   â”œâ”€ ç¯å¢ƒ: æµ‹è¯•ç½‘ (Goerli / BSC Testnet)
   â”œâ”€ æ•°æ®: ä½¿ç”¨æµ‹è¯•æ•°æ®
   â””â”€ æ¸…ç†: æµ‹è¯•åæ¸…ç†æ•°æ®

3. æ€§èƒ½æµ‹è¯•
   â”œâ”€ å·¥å…·: go test -bench
   â”œâ”€ åŸºå‡†: å»ºç«‹æ€§èƒ½åŸºçº¿
   â”œâ”€ å›å½’: æ¯æ¬¡å‘å¸ƒå‰è¿è¡Œ
   â””â”€ æŠ¥å‘Š: æ€§èƒ½æŠ¥å‘Šå½’æ¡£

4. æµ‹è¯•ç¤ºä¾‹:
   ```
   func TestCalculateProfit(t *testing.T) {
       tests := []struct {
           name       string
           buyPrice   float64
           sellPrice  float64
           amount     float64
           wantProfit float64
           wantErr    bool
       }{
           {
               name:       "æ­£å¸¸è®¡ç®—æ”¶ç›Š",
               buyPrice:   43000,
               sellPrice:  43250,
               amount:     0.1,
               wantProfit: 25,
               wantErr:    false,
           },
       }
       // ... æµ‹è¯•é€»è¾‘
   }
   ```
```

#### 1.5.3 æ–‡æ¡£è¦æ±‚

```
æ–‡æ¡£è§„èŒƒ:

1. ä»£ç æ–‡æ¡£
   â”œâ”€ README.md: é¡¹ç›®è¯´æ˜
   â”œâ”€ API æ–‡æ¡£: Swagger/OpenAPIï¼ˆå¯é€‰ï¼‰
   â”œâ”€ æ¶æ„æ–‡æ¡£: ç³»ç»Ÿæ¶æ„å›¾
   â””â”€ éƒ¨ç½²æ–‡æ¡£: éƒ¨ç½²æ­¥éª¤è¯´æ˜

2. ä»£ç æ³¨é‡Š
   â”œâ”€ åŒ…æ³¨é‡Š: æ¯ä¸ª package éƒ½æœ‰æ³¨é‡Š
   â”œâ”€ å¯¼å‡ºå‡½æ•°: éƒ½æœ‰æ³¨é‡Š
   â”œâ”€ å¤æ‚ç®—æ³•: è¯¦ç»†æ³¨é‡Š
   â””â”€ æ³¨é‡Šç‡: â‰¥ 60%

3. ç»´æŠ¤æ–‡æ¡£
   â”œâ”€ æ›´æ–°æ—¥å¿—: CHANGELOG.md
   â”œâ”€ é—®é¢˜è·Ÿè¸ª: GitHub Issues
   â””â”€ çŸ¥è¯†åº“: Wiki æˆ– Notion
```

#### 1.5.4 æ—¥å¿—è®°å½•

```
æ—¥å¿—è§„èŒƒ:

1. æ—¥å¿—çº§åˆ«
   â”œâ”€ DEBUG: è°ƒè¯•ä¿¡æ¯ï¼ˆå¼€å‘ç¯å¢ƒï¼‰
   â”œâ”€ INFO: ä¸€èˆ¬ä¿¡æ¯ï¼ˆç”Ÿäº§ç¯å¢ƒé»˜è®¤ï¼‰
   â”œâ”€ WARN: è­¦å‘Šä¿¡æ¯ï¼ˆéœ€è¦å…³æ³¨ï¼‰
   â”œâ”€ ERROR: é”™è¯¯ä¿¡æ¯ï¼ˆéœ€è¦å¤„ç†ï¼‰
   â””â”€ FATAL: è‡´å‘½é”™è¯¯ï¼ˆæœåŠ¡ç»ˆæ­¢ï¼‰

2. æ—¥å¿—æ ¼å¼
   â”œâ”€ æ ¼å¼: JSONï¼ˆç»“æ„åŒ–æ—¥å¿—ï¼‰
   â”œâ”€ å­—æ®µ:
   â”‚   â”œâ”€ time: æ—¶é—´æˆ³
   â”‚   â”œâ”€ level: æ—¥å¿—çº§åˆ«
   â”‚   â”œâ”€ module: æ¨¡å—åç§°
   â”‚   â”œâ”€ msg: æ—¥å¿—æ¶ˆæ¯
   â”‚   â”œâ”€ fields: é™„åŠ å­—æ®µï¼ˆkey-valueï¼‰
   â”‚   â””â”€ stack_trace: å †æ ˆè·Ÿè¸ªï¼ˆERROR/FATALï¼‰

3. æ—¥å¿—ç¤ºä¾‹:
   ```json
   {
     "time": "2026-01-07T10:30:00.123Z",
     "level": "INFO",
     "module": "trade_executor",
     "msg": "è®¢å•æ‰§è¡ŒæˆåŠŸ",
     "fields": {
       "order_id": "local_order_001",
       "symbol": "BTC/USDT",
       "amount": 0.1,
       "profit": 2.98
     }
   }
   ```

4. æ—¥å¿—ç®¡ç†
   â”œâ”€ æ—¥å¿—è½®è½¬: æ¯å¤© 00:00
   â”œâ”€ æ—¥å¿—å‹ç¼©: 7 å¤©å‰çš„æ—¥å¿—è‡ªåŠ¨å‹ç¼©
   â”œâ”€ æ—¥å¿—æ¸…ç†: 90 å¤©å‰çš„æ—¥å¿—è‡ªåŠ¨åˆ é™¤
   â””â”€ æ—¥å¿—çº§åˆ«: å¯åŠ¨æ€è°ƒæ•´ï¼ˆä¸é‡å¯æœåŠ¡ï¼‰
```

---

## 2. æ•°æ®éœ€æ±‚

### 2.1 æ ¸å¿ƒæ•°æ®å®ä½“

#### 2.1.1 äº¤æ˜“æ‰€ä¿¡æ¯

```go
// Exchange äº¤æ˜“æ‰€ä¿¡æ¯
type Exchange struct {
    ID          string    `json:"id" gorm:"primaryKey"`          // äº¤æ˜“æ‰€ID
    Name        string    `json:"name" gorm:"unique"`            // äº¤æ˜“æ‰€åç§°
    Type        string    `json:"type"`                          // ç±»å‹: CEX/DEX
    APIEndpoint string    `json:"api_endpoint"`                  // API ç«¯ç‚¹
    WSEndpoint  string    `json:"ws_endpoint"`                   // WebSocket ç«¯ç‚¹
    Enabled     bool      `json:"enabled"`                       // æ˜¯å¦å¯ç”¨
    CreatedAt   time.Time `json:"created_at"`
    UpdatedAt   time.Time `json:"updated_at"`
}
```

#### 2.1.2 äº¤æ˜“å¯¹ä¿¡æ¯

```go
// TradingPair äº¤æ˜“å¯¹ä¿¡æ¯
type TradingPair struct {
    ID          string    `json:"id" gorm:"primaryKey"`   // äº¤æ˜“å¯¹ID
    Symbol      string    `json:"symbol" gorm:"unique"`  // äº¤æ˜“å¯¹ç¬¦å·: BTC/USDT
    BaseAsset   string    `json:"base_asset"`            // åŸºç¡€èµ„äº§: BTC
    QuoteAsset  string    `json:"quote_asset"`           // è®¡ä»·èµ„äº§: USDT
    Enabled     bool      `json:"enabled"`               // æ˜¯å¦å¯ç”¨
    CreatedAt   time.Time `json:"created_at"`
    UpdatedAt   time.Time `json:"updated_at"`
}
```

#### 2.1.3 ä»·æ ¼æ•°æ®

```go
// PriceData ä»·æ ¼æ•°æ®
type PriceData struct {
    ID          uint      `json:"id" gorm:"primaryKey"`
    Exchange    string    `json:"exchange"`               // äº¤æ˜“æ‰€
    Symbol      string    `json:"symbol"`                 // äº¤æ˜“å¯¹
    BidPrice    float64   `json:"bid_price"`              // ä¹°ä¸€ä»·
    BidQty      float64   `json:"bid_qty"`                // ä¹°ä¸€é‡
    AskPrice    float64   `json:"ask_price"`              // å–ä¸€ä»·
    AskQty      float64   `json:"ask_qty"`                // å–ä¸€é‡
    Timestamp   int64     `json:"timestamp"`              // æ—¶é—´æˆ³ï¼ˆæ¯«ç§’ï¼‰
    ReceivedAt  time.Time `json:"received_at"`            // æ¥æ”¶æ—¶é—´
    CreatedAt   time.Time `json:"created_at"`
}

// ç´¢å¼•:
// - idx_exchange_symbol: (exchange, symbol)
// - idx_timestamp: (timestamp)
```

#### 2.1.4 è®¢å•æ•°æ®

```go
// Order è®¢å•æ•°æ®
type Order struct {
    ID              string    `json:"id" gorm:"primaryKey"`     // è®¢å•ID
    ExecutionID     string    `json:"execution_id"`            // æ‰§è¡ŒID
    Exchange        string    `json:"exchange"`                // äº¤æ˜“æ‰€
    Symbol          string    `json:"symbol"`                  // äº¤æ˜“å¯¹
    Side            string    `json:"side"`                    // ä¹°å–æ–¹å‘: BUY/SELL
    Type            string    `json:"type"`                    // è®¢å•ç±»å‹: LIMIT/MARKET
    Price           float64   `json:"price"`                   // ä»·æ ¼
    Amount          float64   `json:"amount"`                  // æ•°é‡
    FilledAmount    float64   `json:"filled_amount"`           // å·²æˆäº¤æ•°é‡
    Fee             float64   `json:"fee"`                     // æ‰‹ç»­è´¹
    Status          string    `json:"status"`                  // è®¢å•çŠ¶æ€
    ExchangeOrderID string    `json:"exchange_order_id"`       // äº¤æ˜“æ‰€è®¢å•ID
    CreatedAt       time.Time `json:"created_at"`
    UpdatedAt       time.Time `json:"updated_at"`
}

// ç´¢å¼•:
// - idx_execution_id: (execution_id)
// - idx_exchange_symbol: (exchange, symbol)
// - idx_status: (status)
```

#### 2.1.5 äº¤æ˜“æ‰§è¡Œè®°å½•

```go
// TradeExecution äº¤æ˜“æ‰§è¡Œè®°å½•
type TradeExecution struct {
    ID              string    `json:"id" gorm:"primaryKey"`     // æ‰§è¡ŒID
    OpportunityID   string    `json:"opportunity_id"`          // å¥—åˆ©æœºä¼šID
    Symbol          string    `json:"symbol"`                  // äº¤æ˜“å¯¹
    BuyExchange     string    `json:"buy_exchange"`            // ä¹°å…¥äº¤æ˜“æ‰€
    SellExchange    string    `json:"sell_exchange"`           // å–å‡ºäº¤æ˜“æ‰€
    BuyPrice        float64   `json:"buy_price"`               // ä¹°å…¥ä»·æ ¼
    SellPrice       float64   `json:"sell_price"`              // å–å‡ºä»·æ ¼
    Amount          float64   `json:"amount"`                  // äº¤æ˜“é‡‘é¢
    EstProfit       float64   `json:"est_profit"`              // é¢„æœŸæ”¶ç›Š
    ActualProfit    float64   `json:"actual_profit"`           // å®é™…æ”¶ç›Š
    Status          string    `json:"status"`                  // æ‰§è¡ŒçŠ¶æ€
    StartedAt       time.Time `json:"started_at"`             // å¼€å§‹æ—¶é—´
    CompletedAt     *time.Time `json:"completed_at"`           // å®Œæˆæ—¶é—´
    CreatedAt       time.Time `json:"created_at"`
    UpdatedAt       time.Time `json:"updated_at"`
}

// ç´¢å¼•:
// - idx_symbol: (symbol)
// - idx_status: (status)
// - idx_started_at: (started_at)
```

#### 2.1.6 å¥—åˆ©æœºä¼šè®°å½•

```go
// ArbitrageOpportunity å¥—åˆ©æœºä¼šè®°å½•
type ArbitrageOpportunity struct {
    ID            string    `json:"id" gorm:"primaryKey"`  // æœºä¼šID
    Symbol        string    `json:"symbol"`                // äº¤æ˜“å¯¹
    BuyExchange   string    `json:"buy_exchange"`         // ä¹°å…¥äº¤æ˜“æ‰€
    SellExchange  string    `json:"sell_exchange"`        // å–å‡ºäº¤æ˜“æ‰€
    BuyPrice      float64   `json:"buy_price"`            // ä¹°å…¥ä»·æ ¼
    SellPrice     float64   `json:"sell_price"`           // å–å‡ºä»·æ ¼
    PriceDiff     float64   `json:"price_diff"`           // ä»·æ ¼å·®
    PriceDiffRate float64   `json:"price_diff_rate"`      // ä»·å·®ç™¾åˆ†æ¯”
    RevenueRate   float64   `json:"revenue_rate"`         // æ”¶ç›Šç‡
    EstRevenue    float64   `json:"est_revenue"`          // é¢„æœŸæ”¶ç›Š
    DiscoveredAt  time.Time `json:"discovered_at"`        // å‘ç°æ—¶é—´
    Executed      bool      `json:"executed"`              // æ˜¯å¦å·²æ‰§è¡Œ
    CreatedAt     time.Time `json:"created_at"`
}

// ç´¢å¼•:
// - idx_symbol_discovered: (symbol, discovered_at)
// - idx_executed: (executed)
```

#### 2.1.7 è´¦æˆ·ä¿¡æ¯

```go
// Account è´¦æˆ·ä¿¡æ¯
type Account struct {
    ID        string    `json:"id" gorm:"primaryKey"`  // è´¦æˆ·ID
    Exchange  string    `json:"exchange"`             // äº¤æ˜“æ‰€
    Balance   float64   `json:"balance"`              // ä½™é¢ï¼ˆUSDTï¼‰
    Currency  string    `json:"currency"`             // å¸ç§
    UpdatedAt time.Time `json:"updated_at"`           // æ›´æ–°æ—¶é—´
}

// ç´¢å¼•:
// - idx_exchange_currency: (exchange, currency)
```

#### 2.1.8 ç³»ç»Ÿé…ç½®

```go
// SystemConfig ç³»ç»Ÿé…ç½®
type SystemConfig struct {
    ID        string    `json:"id" gorm:"primaryKey"`  // é…ç½®ID
    Key       string    `json:"key" gorm:"unique"`     // é…ç½®é”®
    Value     string    `json:"value"`                 // é…ç½®å€¼ï¼ˆJSONï¼‰
    ValueType string    `json:"value_type"`            // å€¼ç±»å‹: string/int/float/bool/json
    UpdatedAt time.Time `json:"updated_at"`
}
```

### 2.2 æ•°æ®å­˜å‚¨

#### 2.2.1 å­˜å‚¨æ–¹æ¡ˆ

| æ•°æ®ç±»å‹ | å­˜å‚¨æ–¹æ¡ˆ | è¯´æ˜ |
|---------|---------|------|
| **å®æ—¶ä»·æ ¼æ•°æ®** | Redis + æ—¶åºæ•°æ®åº“ï¼ˆå¯é€‰ï¼‰ | Redis ç¼“å­˜ï¼ŒInfluxDB/Prometheus å¯é€‰ |
| **å†å²ä»·æ ¼æ•°æ®** | æ–‡ä»¶å­˜å‚¨æˆ–æ—¶åºæ•°æ®åº“ | ä¿ç•™ 24 å°æ—¶ï¼Œå¯å‹ç¼©å­˜å‚¨ |
| **äº¤æ˜“è®°å½•** | MySQL/PostgreSQL | æ°¸ä¹…ä¿ç•™ï¼Œå®šæœŸå½’æ¡£ |
| **é…ç½®æ•°æ®** | YAML/JSON æ–‡ä»¶ | ç‰ˆæœ¬æ§åˆ¶ |
| **æ—¥å¿—æ•°æ®** | æ—¥å¿—æ–‡ä»¶ + æ—¥å¿—æ”¶é›†ç³»ç»Ÿ | æœ¬åœ°æ–‡ä»¶ + å¯é€‰çš„ ELK/Loki |

#### 2.2.2 æ•°æ®åº“é€‰å‹

**ä¸»æ•°æ®åº“**: MySQL 8.0+

```yaml
# æ¨èé…ç½®:
æ•°æ®åº“å¼•æ“: InnoDB
å­—ç¬¦é›†: utf8mb4
æ’åºè§„åˆ™: utf8mb4_unicode_ci
æ—¶åŒº: UTC
è¿æ¥æ± : æœ€å¤§ 50 è¿æ¥
è¶…æ—¶: 30 ç§’
```

**å¤‡é€‰æ•°æ®åº“**: PostgreSQL 14+

```yaml
# é€‚ç”¨åœºæ™¯:
- éœ€è¦ JSON ç±»å‹æ”¯æŒ
- éœ€è¦æ›´å¼ºå¤§çš„æŸ¥è¯¢åŠŸèƒ½
- éœ€è¦æ›´å¥½çš„å¹¶å‘æ€§èƒ½
```

#### 2.2.3 ç¼“å­˜æ–¹æ¡ˆ

**Redis ç¼“å­˜**ï¼ˆå¯é€‰ï¼‰:

```
ç¼“å­˜ç­–ç•¥:

1. ä»·æ ¼æ•°æ®ç¼“å­˜
   â”œâ”€ Key: price:{exchange}:{symbol}
   â”œâ”€ TTL: 100ms
   â””â”€ ç”¨é€”: å‡å°‘ DEX è°ƒç”¨

2. è´¦æˆ·ä½™é¢ç¼“å­˜
   â”œâ”€ Key: balance:{exchange}:{currency}
   â”œâ”€ TTL: 5s
   â””â”€ ç”¨é€”: å‡å°‘ API è°ƒç”¨

3. å¥—åˆ©æœºä¼šç¼“å­˜
   â”œâ”€ Key: opportunity:{symbol}:{buy_exchange}:{sell_exchange}
   â”œâ”€ TTL: 1s
   â””â”€ ç”¨é€”: é˜²æ­¢é‡å¤æ‰§è¡Œ

4. é…ç½®ç¼“å­˜
   â”œâ”€ Key: config:{key}
   â”œâ”€ TTL: æ°¸ä¹…ï¼ˆä¸»åŠ¨å¤±æ•ˆï¼‰
   â””â”€ ç”¨é€”: å¿«é€Ÿè®¿é—®é…ç½®
```

### 2.3 æ•°æ®ä¿ç•™ç­–ç•¥

| æ•°æ®ç±»å‹ | ä¿ç•™æ—¶é—´ | æ¸…ç†ç­–ç•¥ | å­˜å‚¨ä½ç½® |
|---------|---------|----------|----------|
| **å®æ—¶ä»·æ ¼æ•°æ®** | 24 å°æ—¶ | è‡ªåŠ¨åˆ é™¤ | Redis / æ–‡ä»¶ |
| **å†å²ä»·æ ¼æ•°æ®** | 30 å¤© | è‡ªåŠ¨åˆ é™¤ | æ—¶åºæ•°æ®åº“ / æ–‡ä»¶ |
| **äº¤æ˜“è®°å½•** | æ°¸ä¹… | å®šæœŸå½’æ¡£ï¼ˆ90 å¤©åï¼‰ | MySQL / PostgreSQL |
| **æ—¥å¿—æ•°æ®** | 90 å¤© | è‡ªåŠ¨åˆ é™¤ | æ—¥å¿—æ–‡ä»¶ |
| **å¥—åˆ©æœºä¼šè®°å½•** | 90 å¤© | è‡ªåŠ¨åˆ é™¤ | MySQL / PostgreSQL |

**å½’æ¡£ç­–ç•¥**:

```
1. äº¤æ˜“è®°å½•å½’æ¡£
   â”œâ”€ å½’æ¡£å‘¨æœŸ: æ¯ 30 å¤©
   â”œâ”€ å½’æ¡£æ–¹å¼: å¯¼å‡ºåˆ° CSV/GZip
   â”œâ”€ å½’æ¡£ä½ç½®: å¯¹è±¡å­˜å‚¨ï¼ˆS3/OSSï¼‰
   â””â”€ ä¿ç•™æ—¶é—´: 3 å¹´

2. æ—¥å¿—å½’æ¡£
   â”œâ”€ å½’æ¡£å‘¨æœŸ: æ¯ 7 å¤©
   â”œâ”€ å½’æ¡£æ–¹å¼: å‹ç¼©ï¼ˆ.gzï¼‰
   â”œâ”€ å½’æ¡£ä½ç½®: å¯¹è±¡å­˜å‚¨ï¼ˆS3/OSSï¼‰
   â””â”€ ä¿ç•™æ—¶é—´: 1 å¹´

3. æ¸…ç†ä»»åŠ¡
   â”œâ”€ æ¸…ç†å·¥å…·: å®šæ—¶ä»»åŠ¡ï¼ˆcronï¼‰
   â”œâ”€ æ¸…ç†æ—¶é—´: å‡Œæ™¨ 3:00
   â””â”€ æ¸…ç†æ—¥å¿—: è®°å½•æ¸…ç†çš„æ•°æ®é‡
```

---

## 3. æ¥å£éœ€æ±‚

### 3.1 å¤–éƒ¨æ¥å£

#### 3.1.1 äº¤æ˜“æ‰€ REST API

**æ”¯æŒçš„äº¤æ˜“æ‰€**:

1. **Binance**
   - API æ–‡æ¡£: https://binance-docs.github.io/apidocs/
   - åŸºç¡€ URL: https://api.binance.com
   - é™æµè§„åˆ™: 1200 è¯·æ±‚/åˆ†é’Ÿ

2. **OKX**
   - API æ–‡æ¡£: https://www.okx.com/docs-v5/
   - åŸºç¡€ URL: https://www.okx.com
   - é™æµè§„åˆ™: 20 è¯·æ±‚/ç§’

3. **Bybit**
   - API æ–‡æ¡£: https://bybit-exchange.github.io/docs/
   - åŸºç¡€ URL: https://api.bybit.com
   - é™æµè§„åˆ™: 100 è¯·æ±‚/ç§’

4. **Coinbase**
   - API æ–‡æ¡£: https://docs.cloud.coinbase.com/exchange/
   - åŸºç¡€ URL: https://exchange.coinbase.com
   - é™æµè§„åˆ™: å–å†³äºè®¤è¯çº§åˆ«

**API ç«¯ç‚¹**:

```
1. è´¦æˆ·ä¿¡æ¯
   â”œâ”€ GET /api/v3/account (Binance)
   â”œâ”€ GET /api/v5/account/balance (OKX)
   â””â”€ åŠŸèƒ½: æŸ¥è¯¢è´¦æˆ·ä½™é¢

2. äº¤æ˜“ä¸‹å•
   â”œâ”€ POST /api/v3/order (Binance)
   â”œâ”€ POST /api/v5/trade/order (OKX)
   â””â”€ åŠŸèƒ½: ä¸‹å•äº¤æ˜“

3. æŸ¥è¯¢è®¢å•
   â”œâ”€ GET /api/v3/order (Binance)
   â”œâ”€ GET /api/v5/trade/order (OKX)
   â””â”€ åŠŸèƒ½: æŸ¥è¯¢è®¢å•çŠ¶æ€

4. å–æ¶ˆè®¢å•
   â”œâ”€ DELETE /api/v3/order (Binance)
   â”œâ”€ POST /api/v5/trade/cancel-order (OKX)
   â””â”€ åŠŸèƒ½: å–æ¶ˆè®¢å•

5. è·å–äº¤æ˜“å¯¹ä¿¡æ¯
   â”œâ”€ GET /api/v3/exchangeInfo (Binance)
   â”œâ”€ GET /api/v5/market/tickers (OKX)
   â””â”€ åŠŸèƒ½: è·å–äº¤æ˜“å¯¹åˆ—è¡¨
```

**é€‚é…å™¨æ¥å£**:

```go
// ExchangeAdapter äº¤æ˜“æ‰€é€‚é…å™¨æ¥å£
type ExchangeAdapter interface {
    // è·å–è´¦æˆ·ä½™é¢
    GetBalance(ctx context.Context, currency string) (float64, error)

    // è·å–äº¤æ˜“å¯¹ä»·æ ¼
    GetTicker(ctx context.Context, symbol string) (*Ticker, error)

    // ä¸‹å•
    PlaceOrder(ctx context.Context, order *Order) (*OrderResult, error)

    // æŸ¥è¯¢è®¢å•
    QueryOrder(ctx context.Context, orderID string) (*Order, error)

    // å–æ¶ˆè®¢å•
    CancelOrder(ctx context.Context, orderID string) error

    // è·å–äº¤æ˜“å¯¹ä¿¡æ¯
    GetTradingPairs(ctx context.Context) ([]TradingPair, error)
}

// Ticker ä»·æ ¼æ•°æ®
type Ticker struct {
    Symbol    string
    BidPrice  float64  // ä¹°ä¸€ä»·
    BidQty    float64  // ä¹°ä¸€é‡
    AskPrice  float64  // å–ä¸€ä»·
    AskQty    float64  // å–ä¸€é‡
    Timestamp int64    // æ—¶é—´æˆ³
}

// OrderResult è®¢å•ç»“æœ
type OrderResult struct {
    OrderID         string  // è®¢å•ID
    ExchangeOrderID string  // äº¤æ˜“æ‰€è®¢å•ID
    Price           float64 // æˆäº¤ä»·æ ¼
    Amount          float64 // æˆäº¤æ•°é‡
    Fee             float64 // æ‰‹ç»­è´¹
    Status          string  // è®¢å•çŠ¶æ€
}
```

#### 3.1.2 äº¤æ˜“æ‰€ WebSocket API

**WebSocket ç«¯ç‚¹**:

```
1. Binance
   â”œâ”€ ç«¯ç‚¹: wss://stream.binance.com:9443/ws
   â”œâ”€ è®¢é˜…: {"method": "SUBSCRIBE", "params": ["btcusdt@ticker"], "id": 1}
   â””â”€ é™æµ: 1024 æ¬¡/10ç§’

2. OKX
   â”œâ”€ ç«¯ç‚¹: wss://ws.okx.com:8443/ws/v5/public
   â”œâ”€ è®¢é˜…: {"op": "subscribe", "args": ["tickers:BTC-USDT"]}
   â””â”€ é™æµ: 240 æ¬¡/åˆ†é’Ÿ

3. Bybit
   â”œâ”€ ç«¯ç‚¹: wss://stream.bybit.com/v5/public/linear
   â”œâ”€ è®¢é˜…: {"op": "subscribe", "args": ["tickers.BTCUSDT"]}
   â””â”€ é™æµ: å–å†³äºè®¤è¯çº§åˆ«
```

**æ¶ˆæ¯æ ¼å¼**:

```go
// WebSocketMessage WebSocket æ¶ˆæ¯
type WebSocketMessage struct {
    Exchange string      // äº¤æ˜“æ‰€
    Symbol   string      // äº¤æ˜“å¯¹
    Type     string      // æ¶ˆæ¯ç±»å‹: ticker/depth/trade
    Data     interface{} // æ¶ˆæ¯æ•°æ®
}

// TickerMessage ä»·æ ¼æ¨é€æ¶ˆæ¯
type TickerMessage struct {
    Symbol    string  `json:"s"`  // äº¤æ˜“å¯¹
    BidPrice  string  `json:"b"`  // ä¹°ä¸€ä»·
    AskPrice  string  `json:"a"`  // å–ä¸€ä»·
    BidQty    string  `json:"B"`  // ä¹°ä¸€é‡
    AskQty    string  `json:"A"`  // å–ä¸€é‡
    Timestamp int64   `json:"E"`  // æ—¶é—´æˆ³
}
```

**è¿æ¥ç®¡ç†**:

```
è¿æ¥ç­–ç•¥:

1. é•¿è¿æ¥ä¿æŒ
   â”œâ”€ å¿ƒè·³é—´éš”: 30 ç§’
   â”œâ”€ è¶…æ—¶æ—¶é—´: 60 ç§’
   â””â”€ é‡è¿ç­–ç•¥: æŒ‡æ•°é€€é¿ï¼ˆ1s, 2s, 4s, 8s, ...ï¼‰

2. æ–­çº¿é‡è¿
   â”œâ”€ æ£€æµ‹: Ping/Pong è¶…æ—¶
   â”œâ”€ é‡è¿: è‡ªåŠ¨é‡è¿
   â”œâ”€ è®¢é˜…æ¢å¤: é‡è¿åé‡æ–°è®¢é˜…
   â””â”€ çŠ¶æ€æŠ¥å‘Š: è®°å½•é‡è¿æ¬¡æ•°å’Œæ—¶é—´

3. æ¶ˆæ¯ç¼“å†²
   â”œâ”€ ç¼“å†²åŒºå¤§å°: 10,000 æ¡æ¶ˆæ¯
   â”œâ”€ æº¢å‡ºç­–ç•¥: ä¸¢å¼ƒæœ€æ—§æ¶ˆæ¯
   â””â”€ å‘Šè­¦: ç¼“å†²åŒºæ»¡æ—¶å‘Šè­¦
```

#### 3.1.3 åŒºå—é“¾èŠ‚ç‚¹ RPCï¼ˆDEX åœºæ™¯ï¼‰

**æ”¯æŒçš„åŒºå—é“¾**:

1. **Ethereum**
   - RPC ç«¯ç‚¹: https://mainnet.infura.io/v3/YOUR_KEY
   - å¤‡é€‰ç«¯ç‚¹: https://eth.llamarpc.com
   - Chain ID: 1

2. **BSC (å¸å®‰æ™ºèƒ½é“¾)**
   - RPC ç«¯ç‚¹: https://bsc-dataseed1.binance.org
   - Chain ID: 56

3. **Arbitrum**
   - RPC ç«¯ç‚¹: https://arb1.arbitrum.io/rpc
   - Chain ID: 42161

**RPC è°ƒç”¨**:

```
1. è·å–åŒºå—å·
   â”œâ”€ æ–¹æ³•: eth_blockNumber
   â””â”€ ç”¨é€”: åŒæ­¥é“¾ä¸ŠçŠ¶æ€

2. è°ƒç”¨åˆçº¦
   â”œâ”€ æ–¹æ³•: eth_call
   â””â”€ ç”¨é€”: æŸ¥è¯¢ DEX ä»·æ ¼

3. å‘é€äº¤æ˜“
   â”œâ”€ æ–¹æ³•: eth_sendRawTransaction
   â””â”€ ç”¨é€”: æ‰§è¡Œ DEX äº¤æ˜“

4. è·å–äº¤æ˜“æ”¶æ®
   â”œâ”€ æ–¹æ³•: eth_getTransactionReceipt
   â””â”€ ç”¨é€”: æŸ¥è¯¢äº¤æ˜“ç»“æœ

5. ä¼°ç®— Gas
   â”œâ”€ æ–¹æ³•: eth_estimateGas
   â””â”€ ç”¨é€”: è®¡ç®— Gas è´¹
```

**Gas ä¼˜åŒ–**:

```
Gas ç®¡ç†ç­–ç•¥:

1. åŠ¨æ€ Gas ä»·æ ¼
   â”œâ”€ è·å–: eth_gasPrice
   â”œâ”€ ç­–ç•¥: å½“å‰ç½‘ç»œä»·æ ¼çš„ 1.1 å€
   â””â”€ ä¸Šé™: 50 Gweiï¼ˆEthereumï¼‰

2. Gas é™é¢ä¼˜åŒ–
   â”œâ”€ ä¼°ç®—: eth_estimateGas
   â”œâ”€ ç­–ç•¥: ä¼°ç®—å€¼ Ã— 1.2
   â””â”€ ä¸Šé™: 300,000 Gas

3. EIP-1559ï¼ˆå¯é€‰ï¼‰
   â”œâ”€ Base Fee: åŠ¨æ€è°ƒæ•´
   â”œâ”€ Priority Fee: 1-2 Gwei
   â””â”€ Max Fee: Base Fee + Priority Fee Ã— 2
```

#### 3.1.4 å‘Šè­¦æœåŠ¡æ¥å£

**æ”¯æŒçš„å‘Šè­¦æ–¹å¼**:

1. **é‚®ä»¶**
   - åè®®: SMTP
   - ç«¯å£: 465 (SSL) / 587 (STARTTLS)
   - è®¤è¯: ç”¨æˆ·å + å¯†ç 

2. **Telegram**
   - API: Telegram Bot API
   - ç«¯ç‚¹: https://api.telegram.org/bot<token>/sendMessage
   - é™åˆ¶: 30 æ¶ˆæ¯/ç§’

3. **ä¼ä¸šå¾®ä¿¡**
   - API: ä¼ä¸šå¾®ä¿¡æœºå™¨äºº
   - ç«¯ç‚¹: https://qyapi.weixin.qq.com/cgi-bin/webhook/send
   - é™åˆ¶: 20 æ¶ˆæ¯/åˆ†é’Ÿ

**å‘Šè­¦æ¥å£**:

```go
// Alerter å‘Šè­¦æ¥å£
type Alerter interface {
    // å‘é€å‘Šè­¦
    SendAlert(ctx context.Context, alert *Alert) error
}

// Alert å‘Šè­¦æ¶ˆæ¯
type Alert struct {
    Level   string // å‘Šè­¦çº§åˆ«: INFO/WARN/ERROR/FATAL
    Title   string // å‘Šè­¦æ ‡é¢˜
    Message string // å‘Šè­¦æ¶ˆæ¯
    Fields  map[string]interface{} // é™„åŠ å­—æ®µ
}
```

### 3.2 å†…éƒ¨æ¥å£

#### 3.2.1 æ¨¡å—é—´é€šä¿¡

```
é€šä¿¡æ–¹å¼:

1. å‡½æ•°è°ƒç”¨ï¼ˆåŒæ­¥ï¼‰
   â”œâ”€ ä»·æ ¼ç›‘æ§ â†’ å¥—åˆ©è¯†åˆ«
   â”œâ”€ å¥—åˆ©è¯†åˆ« â†’ é£é™©æ§åˆ¶
   â””â”€ é£é™©æ§åˆ¶ â†’ äº¤æ˜“æ‰§è¡Œ

2. Channelï¼ˆå¼‚æ­¥ï¼‰
   â”œâ”€ ä»·æ ¼æ•°æ®æµ: price_chan chan *PriceData
   â”œâ”€ å¥—åˆ©æœºä¼šæµ: opp_chan chan *ArbitrageOpportunity
   â””â”€ è®¢å•ç»“æœæµ: result_chan chan *OrderResult

3. Contextï¼ˆä¼ é€’ï¼‰
   â”œâ”€ è¶…æ—¶æ§åˆ¶: context.WithTimeout
   â”œâ”€ å–æ¶ˆæ“ä½œ: context.WithCancel
   â””â”€ è¯·æ±‚é“¾è·¯è¿½è¸ª: context.WithValue
```

#### 3.2.2 æ•°æ®æµæ¥å£

```
æ•°æ®æµå‘:

1. ä»·æ ¼æ•°æ®æµ
   WebSocket â†’ PriceParser â†’ PriceChannel â†’ ArbitrageDetector
                         â†“
                    PriceCache (Redis)

2. å¥—åˆ©æœºä¼šæµ
   ArbitrageDetector â†’ OppChannel â†’ RiskManager â†’ TradeExecutor
                                         â†“
                                   OpportunityDB

3. è®¢å•æ‰§è¡Œæµ
   TradeExecutor â†’ ExchangeAPI â†’ OrderResultChannel â†’ AccountManager
                                                     â†“
                                                   TradeDB
```

### 3.3 ç®¡ç†æ¥å£ï¼ˆå¯é€‰ï¼‰

#### 3.3.1 HTTP API

**åŸºç¡€ URL**: `http://localhost:8888/api/v1`

**API ç«¯ç‚¹**:

```
1. ç³»ç»ŸçŠ¶æ€
   â”œâ”€ GET /status
   â”œâ”€ è¿”å›: ç³»ç»ŸçŠ¶æ€ã€è¿è¡Œæ—¶é—´ã€Goroutine æ•°é‡
   â””â”€ ç”¨é€”: å¥åº·æ£€æŸ¥

2. è´¦æˆ·ä½™é¢
   â”œâ”€ GET /accounts
   â”œâ”€ è¿”å›: æ‰€æœ‰äº¤æ˜“æ‰€çš„è´¦æˆ·ä½™é¢
   â””â”€ ç”¨é€”: æŸ¥è¯¢èµ„é‡‘åˆ†å¸ƒ

3. äº¤æ˜“è®°å½•
   â”œâ”€ GET /executions
   â”œâ”€ å‚æ•°: page, page_size, status, symbol
   â”œâ”€ è¿”å›: äº¤æ˜“æ‰§è¡Œè®°å½•åˆ—è¡¨
   â””â”€ ç”¨é€”: æŸ¥è¯¢å†å²äº¤æ˜“

4. æ”¶ç›Šç»Ÿè®¡
   â”œâ”€ GET /stats/profit
   â”œâ”€ å‚æ•°: start_date, end_date
   â”œâ”€ è¿”å›: æ”¶ç›Šç»Ÿè®¡ï¼ˆæ€»æ”¶ç›Šã€èƒœç‡ã€æœ€å¤§å›æ’¤ç­‰ï¼‰
   â””â”€ ç”¨é€”: æ€§èƒ½åˆ†æ

5. é…ç½®ç®¡ç†
   â”œâ”€ GET /config/{key}
   â”œâ”€ PUT /config/{key}
   â””â”€ ç”¨é€”: åŠ¨æ€æ›´æ–°é…ç½®

6. æ‰‹åŠ¨æ§åˆ¶
   â”œâ”€ POST /start - å¯åŠ¨ç³»ç»Ÿ
   â”œâ”€ POST /stop - åœæ­¢ç³»ç»Ÿ
   â”œâ”€ POST /pause - æš‚åœäº¤æ˜“
   â””â”€ POST /resume - æ¢å¤äº¤æ˜“
```

**API è®¤è¯**ï¼ˆå¯é€‰ï¼‰:

```
è®¤è¯æ–¹å¼:

1. API Key
   â”œâ”€ Header: X-API-Key: <api_key>
   â”œâ”€ ä½ç½®: è¯·æ±‚å¤´
   â””â”€ ç”¨é€”: API è®¿é—®æ§åˆ¶

2. JWT Tokenï¼ˆå¯é€‰ï¼‰
   â”œâ”€ Header: Authorization: Bearer <token>
   â”œâ”€ æœ‰æ•ˆæœŸ: 24 å°æ—¶
   â””â”€ ç”¨é€”: æ›´å®‰å…¨çš„è®¤è¯
```

#### 3.3.2 CLI å‘½ä»¤è¡Œå·¥å…·ï¼ˆå¯é€‰ï¼‰

```
å‘½ä»¤ç¤ºä¾‹:

1. å¯åŠ¨æœåŠ¡
   â”œâ”€ ./arbitragex start -config config.yaml
   â””â”€ ç”¨é€”: å¯åŠ¨å¥—åˆ©ç³»ç»Ÿ

2. æŸ¥è¯¢çŠ¶æ€
   â”œâ”€ ./arbitragex status
   â””â”€ ç”¨é€”: æŸ¥çœ‹ç³»ç»ŸçŠ¶æ€

3. æŸ¥è¯¢ä½™é¢
   â”œâ”€ ./arbitragex balance --exchange binance
   â””â”€ ç”¨é€”: æŸ¥è¯¢è´¦æˆ·ä½™é¢

4. æŸ¥è¯¢æ”¶ç›Š
   â”œâ”€ ./arbitragex profit --days 7
   â””â”€ ç”¨é€”: æŸ¥è¯¢æœ€è¿‘ 7 å¤©æ”¶ç›Š

5. æµ‹è¯•è¿æ¥
   â”œâ”€ ./arbitragex test --exchange okx
   â””â”€ ç”¨é€”: æµ‹è¯•äº¤æ˜“æ‰€ API è¿æ¥
```

---

## 4. æŠ€æœ¯çº¦æŸ

### 4.1 å¼€å‘è¯­è¨€å’Œæ¡†æ¶

**åç«¯å¼€å‘è¯­è¨€**: Go 1.21+

```
é€‰å‹åŸå› :
â”œâ”€ æ€§èƒ½: é«˜æ€§èƒ½ã€ä½å»¶è¿Ÿ
â”œâ”€ å¹¶å‘: åŸç”Ÿæ”¯æŒ Goroutine
â”œâ”€ ç”Ÿæ€: ä¸°å¯Œçš„åº“æ”¯æŒ
â””â”€ éƒ¨ç½²: å•ä¸€å¯æ‰§è¡Œæ–‡ä»¶ï¼Œæ˜“äºéƒ¨ç½²
```

**åç«¯æ¡†æ¶**: go-zero v1.9.4

```
æ¡†æ¶ç‰¹æ€§:
â”œâ”€ å¾®æœåŠ¡æ¡†æ¶
â”œâ”€ å†…ç½® RPCã€HTTPã€WebSocket æ”¯æŒ
â”œâ”€ è‡ªåŠ¨ç”Ÿæˆä»£ç ï¼ˆgoctlï¼‰
â”œâ”€ å†…ç½®é™æµã€ç†”æ–­ã€é™çº§
â””â”€ å®Œå–„çš„ç›‘æ§å’Œæ—¥å¿—
```

**å…¶ä»–æŠ€æœ¯æ ˆ**:

| æŠ€æœ¯ | ç‰ˆæœ¬ | ç”¨é€” |
|------|------|------|
| **æ•°æ®åº“** | MySQL 8.0+ | ä¸»æ•°æ®åº“ |
| **æ•°æ®åº“** | PostgreSQL 14+ | å¤‡é€‰æ•°æ®åº“ |
| **ç¼“å­˜** | Redis 7+ | å¯é€‰ç¼“å­˜å±‚ |
| **åŒºå—é“¾** | go-ethereum 1.13+ | ä»¥å¤ªåŠäº¤äº’ |
| **æ—¥å¿—** | uber-go/zap | ç»“æ„åŒ–æ—¥å¿— |
| **é…ç½®** | spf13/viper | é…ç½®ç®¡ç† |
| **HTTP å®¢æˆ·ç«¯** | go-resty/resty/v2 | HTTP è¯·æ±‚ |
| **WebSocket** | gorilla/websocket | WebSocket å®¢æˆ·ç«¯ |

### 4.2 éƒ¨ç½²ç¯å¢ƒ

**æ“ä½œç³»ç»Ÿ**:
- Linuxï¼ˆæ¨è Ubuntu 22.04 LTS / CentOS 8ï¼‰
- Docker å®¹å™¨éƒ¨ç½²

**è¿è¡Œæ—¶ç¯å¢ƒ**:
- Go 1.21+
- MySQL 8.0+
- Redis 7+ï¼ˆå¯é€‰ï¼‰

**æœåŠ¡å™¨é…ç½®**:
- CPU: 4 æ ¸+
- å†…å­˜: 8GB+
- ç£ç›˜: 100GB+ SSD
- ç½‘ç»œ: 100Mbps+

### 4.3 ç¬¬ä¸‰æ–¹åº“ä¾èµ–

```
æ ¸å¿ƒä¾èµ–:

require (
    github.com/zeromicro/go-zero v1.9.4
    github.com/go-resty/resty/v2 v2.11.0
    github.com/gorilla/websocket v1.5.3
    github.com/ethereum/go-ethereum v1.13.8
    github.com/spf13/viper v1.18.2
    go.uber.org/zap v1.26.0
    gorm.io/gorm v1.25.10
    gorm.io/driver/mysql v1.5.6
)
```

### 4.4 å¼€å‘å·¥å…·

```
å¼€å‘å·¥å…·:

1. ä»£ç ç”Ÿæˆ
   â”œâ”€ goctl: go-zero ä»£ç ç”Ÿæˆå·¥å…·
   â”œâ”€ mockgen: Mock ä»£ç ç”Ÿæˆ
   â””â”€ swagger: API æ–‡æ¡£ç”Ÿæˆ

2. ä»£ç è´¨é‡
   â”œâ”€ golangci-lint: ä»£ç æ£€æŸ¥
   â”œâ”€ gofmt: ä»£ç æ ¼å¼åŒ–
   â”œâ”€ goimports: å¯¼å…¥ä¼˜åŒ–
   â””â”€ gocyclo: å¤æ‚åº¦æ£€æŸ¥

3. æµ‹è¯•å·¥å…·
   â”œâ”€ go test: å•å…ƒæµ‹è¯•
   â”œâ”€ go benchmark: æ€§èƒ½æµ‹è¯•
   â”œâ”€ go race: ç«æ€æ£€æµ‹
   â””â”€ go cover: è¦†ç›–ç‡æµ‹è¯•

4. ç‰ˆæœ¬æ§åˆ¶
   â”œâ”€ Git: ç‰ˆæœ¬æ§åˆ¶
   â”œâ”€ GitHub: ä»£ç æ‰˜ç®¡
   â””â”€ Git Flow: åˆ†æ”¯ç®¡ç†
```

---

## 5. éƒ¨ç½²å’Œè¿ç»´éœ€æ±‚

### 5.1 éƒ¨ç½²æ¶æ„

```
éƒ¨ç½²æ¶æ„:

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   è´Ÿè½½å‡è¡¡ï¼ˆå¯é€‰ï¼‰                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚                       â”‚
â”Œâ”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”
â”‚  ä»·æ ¼ç›‘æ§   â”‚        â”‚ å¥—åˆ©å¼•æ“ â”‚
â”‚   æœåŠ¡     â”‚        â”‚   æœåŠ¡   â”‚
â””â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
    â”‚                       â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚     æ•°æ®åº“ (MySQL)    â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**éƒ¨ç½²æ¨¡å¼**:

1. **å•æœºéƒ¨ç½²**ï¼ˆMVPï¼‰
   - æ‰€æœ‰æœåŠ¡éƒ¨ç½²åœ¨ä¸€å°æœåŠ¡å™¨
   - é€‚åˆæµ‹è¯•å’Œå°è§„æ¨¡è¿è¡Œ

2. **åˆ†å¸ƒå¼éƒ¨ç½²**ï¼ˆç”Ÿäº§ï¼‰
   - ä»·æ ¼ç›‘æ§æœåŠ¡ç‹¬ç«‹éƒ¨ç½²
   - å¥—åˆ©å¼•æ“æœåŠ¡ç‹¬ç«‹éƒ¨ç½²
   - æ•°æ®åº“ä¸»ä»éƒ¨ç½²

### 5.2 Docker éƒ¨ç½²

**Dockerfile**:

```dockerfile
FROM golang:1.21-alpine AS builder

WORKDIR /build
COPY go.mod go.sum ./
RUN go mod download
COPY . .
RUN CGO_ENABLED=0 go build -o arbitragex ./cmd/main

FROM alpine:latest
RUN apk --no-cache add ca-certificates tzdata
WORKDIR /app
COPY --from=builder /build/arbitragex .
COPY config/config.yaml .
ENV TZ=Asia/Shanghai
CMD ["./arbitragex", "-f", "config/config.yaml"]
```

**docker-compose.yml**:

```yaml
version: '3.8'

services:
  mysql:
    image: mysql:8.0
    environment:
      MYSQL_ROOT_PASSWORD: root_password
      MYSQL_DATABASE: arbitragex
      MYSQL_USER: arbitragex_user
      MYSQL_PASSWORD: ArbitrageX2025!
    ports:
      - "3306:3306"
    volumes:
      - ./data/mysql:/var/lib/mysql
      - ./scripts/mysql:/docker-entrypoint-initdb.d

  arbitragex:
    build: .
    depends_on:
      - mysql
    environment:
      - ENV=production
    volumes:
      - ./config:/app/config
      - ./logs:/app/logs
    restart: always
```

### 5.3 ç›‘æ§å’Œå‘Šè­¦

**ç›‘æ§æŒ‡æ ‡**:

```
1. ç³»ç»ŸæŒ‡æ ‡
   â”œâ”€ CPU ä½¿ç”¨ç‡
   â”œâ”€ å†…å­˜ä½¿ç”¨ç‡
   â”œâ”€ ç£ç›˜ä½¿ç”¨ç‡
   â”œâ”€ ç½‘ç»œå¸¦å®½
   â””â”€ Goroutine æ•°é‡

2. ä¸šåŠ¡æŒ‡æ ‡
   â”œâ”€ ä»·æ ¼æ›´æ–°å»¶è¿Ÿ
   â”œâ”€ å¥—åˆ©æœºä¼šæ•°é‡
   â”œâ”€ äº¤æ˜“æˆåŠŸç‡
   â”œâ”€ æ”¶ç›Šç»Ÿè®¡
   â””â”€ Gas è´¹ç»Ÿè®¡

3. API æŒ‡æ ‡
   â”œâ”€ API è°ƒç”¨æ¬¡æ•°
   â”œâ”€ API å“åº”æ—¶é—´
   â”œâ”€ API é”™è¯¯ç‡
   â””â”€ API é™æµæ¬¡æ•°
```

**ç›‘æ§å·¥å…·**:

- Prometheus + Grafanaï¼ˆæ¨èï¼‰
- go-zero å†…ç½®ç›‘æ§
- è‡ªå®šä¹‰ç›‘æ§æŒ‡æ ‡

**å‘Šè­¦è§„åˆ™**:

```
å‘Šè­¦é…ç½®:

1. ç³»ç»Ÿå‘Šè­¦
   â”œâ”€ CPU ä½¿ç”¨ç‡ > 80%
   â”œâ”€ å†…å­˜ä½¿ç”¨ç‡ > 90%
   â”œâ”€ ç£ç›˜ä½¿ç”¨ç‡ > 90%
   â””â”€ Goroutine æ•°é‡ > 3000

2. ä¸šåŠ¡å‘Šè­¦
   â”œâ”€ äº¤æ˜“æˆåŠŸç‡ < 80%
   â”œâ”€ API å¤±è´¥ç‡ > 10%
   â”œâ”€ ä»·æ ¼å»¶è¿Ÿ > 1s
   â””â”€ Gas è´¹ > 50 USDT

3. å‘Šè­¦æ–¹å¼
   â”œâ”€ é‚®ä»¶: ç«‹å³å‘é€
   â”œâ”€ Telegram: ç«‹å³å‘é€
   â””â”€ ä¼ä¸šå¾®ä¿¡: ç«‹å³å‘é€
```

### 5.4 æ—¥å¿—ç®¡ç†

**æ—¥å¿—æ”¶é›†**ï¼ˆå¯é€‰ï¼‰:

```
æ—¥å¿—æ–¹æ¡ˆ:

1. æœ¬åœ°æ–‡ä»¶ï¼ˆé»˜è®¤ï¼‰
   â”œâ”€ ä½ç½®: /var/log/arbitragex/
   â”œâ”€ è½®è½¬: æ¯å¤© 00:00
   â”œâ”€ å‹ç¼©: 7 å¤©å‰çš„æ—¥å¿—è‡ªåŠ¨å‹ç¼©
   â””â”€ æ¸…ç†: 90 å¤©å‰çš„æ—¥å¿—è‡ªåŠ¨åˆ é™¤

2. ELK Stackï¼ˆå¯é€‰ï¼‰
   â”œâ”€ Elasticsearch: æ—¥å¿—å­˜å‚¨
   â”œâ”€ Logstash: æ—¥å¿—æ”¶é›†
   â””â”€ Kibana: æ—¥å¿—æŸ¥è¯¢

3. Lokiï¼ˆå¯é€‰ï¼‰
   â”œâ”€ Prometheus: æ—¥å¿—å­˜å‚¨
   â”œâ”€ Promtail: æ—¥å¿—æ”¶é›†
   â””â”€ Grafana: æ—¥å¿—æŸ¥è¯¢
```

### 5.5 å¤‡ä»½å’Œæ¢å¤

**å¤‡ä»½ç­–ç•¥**:

```
1. æ•°æ®åº“å¤‡ä»½
   â”œâ”€ å…¨é‡å¤‡ä»½: æ¯å¤©å‡Œæ™¨ 2 ç‚¹
   â”œâ”€ å¢é‡å¤‡ä»½: æ¯ 4 å°æ—¶
   â”œâ”€ binlog å¤‡ä»½: å®æ—¶
   â””â”€ ä¿ç•™æ—¶é—´: 30 å¤©

2. é…ç½®å¤‡ä»½
   â”œâ”€ å¤‡ä»½å·¥å…·: Git
   â”œâ”€ å¤‡ä»½é¢‘ç‡: æ¯æ¬¡ä¿®æ”¹
   â””â”€ ä¿ç•™æ—¶é—´: æ°¸ä¹…

3. å¤‡ä»½éªŒè¯
   â”œâ”€ éªŒè¯é¢‘ç‡: æ¯å‘¨ä¸€æ¬¡
   â”œâ”€ æ¢å¤æµ‹è¯•: è‡ªåŠ¨åŒ–æµ‹è¯•
   â””â”€ éªŒè¯æŠ¥å‘Š: è®°å½•éªŒè¯ç»“æœ
```

**æ¢å¤æµç¨‹**:

```
1. æ•°æ®åº“æ¢å¤
   â”œâ”€ åœæ­¢æœåŠ¡
   â”œâ”€ æ¢å¤å…¨é‡å¤‡ä»½
   â”œâ”€ åº”ç”¨å¢é‡å¤‡ä»½
   â”œâ”€ éªŒè¯æ•°æ®å®Œæ•´æ€§
   â””â”€ å¯åŠ¨æœåŠ¡

2. é…ç½®æ¢å¤
   â”œâ”€ ä» Git æ‹‰å–é…ç½®
   â”œâ”€ éªŒè¯é…ç½®æ­£ç¡®æ€§
   â””â”€ é‡å¯æœåŠ¡
```

---

## 6. é™„å½•

### 6.1 æ€§èƒ½ä¼˜åŒ–å»ºè®®

```
æ€§èƒ½ä¼˜åŒ–æ¸…å•:

1. æ•°æ®åº“ä¼˜åŒ–
   â”œâ”€ æ·»åŠ ç´¢å¼•: çƒ­ç‚¹å­—æ®µ
   â”œâ”€ åˆ†åŒºè¡¨: æŒ‰æœˆåˆ†åŒº
   â”œâ”€ è¯»å†™åˆ†ç¦»: ä¸»ä»å¤åˆ¶
   â””â”€ è¿æ¥æ± : æœ€å¤§ 50 è¿æ¥

2. ç¼“å­˜ä¼˜åŒ–
   â”œâ”€ ä»·æ ¼æ•°æ®: Redis ç¼“å­˜ï¼ˆTTL: 100msï¼‰
   â”œâ”€ ä½™é¢æ•°æ®: Redis ç¼“å­˜ï¼ˆTTL: 5sï¼‰
   â””â”€ é…ç½®æ•°æ®: å†…å­˜ç¼“å­˜

3. å¹¶å‘ä¼˜åŒ–
   â”œâ”€ Goroutine æ± : æœ€å¤§ 2000 ä¸ª
   â”œâ”€ é™åˆ¶å¹¶å‘: å•äº¤æ˜“æ‰€ â‰¤ 10 QPS
   â””â”€ ä½¿ç”¨ Channel: é¿å…å…±äº«å†…å­˜

4. ç®—æ³•ä¼˜åŒ–
   â”œâ”€ å¥—åˆ©è¯†åˆ«: O(nÂ²) â†’ O(n)
   â”œâ”€ ä½¿ç”¨å †: å¿«é€Ÿæ‰¾åˆ°æœ€å¤§ä»·å·®
   â””â”€ ç¼“å­˜ç»“æœ: é¿å…é‡å¤è®¡ç®—
```

### 6.2 å®‰å…¨æ£€æŸ¥æ¸…å•

```
å®‰å…¨æ£€æŸ¥:

- [ ] API å¯†é’¥åŠ å¯†å­˜å‚¨ï¼ˆAES-256ï¼‰
- [ ] API å¯†é’¥æƒé™æœ€å°åŒ–
- [ ] IP ç™½åå•é…ç½®
- [ ] ä¼ è¾“åŠ å¯†ï¼ˆTLS 1.3ï¼‰
- [ ] æ—¥å¿—è„±æ•ï¼ˆæ•æ„Ÿä¿¡æ¯ï¼‰
- [ ] æ“ä½œå®¡è®¡æ—¥å¿—
- [ ] å®šæœŸå®‰å…¨å®¡è®¡
- [ ] ä¾èµ–åº“æ¼æ´æ‰«æ
- [ ] æ™ºèƒ½åˆçº¦ä»£ç å®¡è®¡ï¼ˆDEXï¼‰
- [ ] Gas è´¹ä¸Šé™æ§åˆ¶
```

### 6.3 å‚è€ƒèµ„æº

**æŠ€æœ¯æ–‡æ¡£**:
- [go-zero å®˜æ–¹æ–‡æ¡£](https://go-zero.dev/)
- [Ethereum å¼€å‘æ–‡æ¡£](https://ethereum.org/developers)
- [MySQL 8.0 æ–‡æ¡£](https://dev.mysql.com/doc/refman/8.0/en/)

**æœ€ä½³å®è·µ**:
- [Go Code Review Comments](https://github.com/golang/go/wiki/CodeReviewComments)
- [Effective Go](https://go.dev/doc/effective_go)
- [Uber Go Style Guide](https://github.com/uber-go/guide)

**ç¤¾åŒºèµ„æº**:
- [go-zero GitHub](https://github.com/zeromicro/go-zero)
- [Ethereum Stack Exchange](https://ethereum.stackexchange.com/)

---

**æ–‡æ¡£ç»“æŸ**

**ä¸‹ä¸€æ­¥è¡ŒåŠ¨**:
1. é˜…è¯» [PRD_Implementation.md](./PRD_Implementation.md) äº†è§£å®æ–½è®¡åˆ’
2. æ­å»ºå¼€å‘ç¯å¢ƒï¼ˆGo 1.21+, MySQL 8.0+ï¼‰
3. å®ç°äº¤æ˜“æ‰€é€‚é…å™¨æ¥å£
4. å¼€å‘ä»·æ ¼ç›‘æ§æ¨¡å—ï¼ˆç¬¬ä¸€ä¸ªæ¨¡å—ï¼‰
